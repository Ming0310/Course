<?=PAGE-HEADER=?>

<script>
// PT71: used to tell banner.html which one is selected  
var selectedTab = 'Wlans';

///////////////////////////////////////
// PT71: re-implemented tab widgets
var lastTab = {
	label: 'tabLabel1',
	tab: 'tab1'
};
var lastSecTab = {
	label: 'sectabLabel1',
	tab: 'sectab1'
};

function clickTab(last, prefix, num) {
	document.getElementById(last.label).className = "dojoTabPaneTab";
	document.getElementById(last.tab).style.display = "none";
	last.label = prefix + 'Label' + num;
	last.tab = prefix + num;
	document.getElementById(last.label).className = "dojoTabPaneTab current";
	document.getElementById(last.tab).style.display = "block";
}
///////////////////////////////////////

var authenType = "<?=WLAN-AUTHEN=?>";
var encryptType = "<?=WLAN-ENCRYPT-TYPE=?>";
var authenKey = "<?=WLAN-AUTHEN-KEY=?>";
var radiusServerIndex = <?=WLAN-RADIUS-SERVER-INDEX=?>;
var availableRadiusServers = <?=AVAILABLE-RADIUS-SERVERS=?>;
var currentInterface = "<?=WLAN-INTERFACE=?>";
var availableInterfaces = <?=WLAN-AVAILABLE-INTERFACES=?>;
var isLocalSwitching = <?=WLAN-IS-LOCAL-SWITCHING=?>;
var isLocalAuth = <?=WLAN-IS-LOCAL-AUTH=?>;

function ptOnload() {
	onloadEvent();
	
	var selectIndex = 0;
	for (var i=0; i<availableRadiusServers.length; i++) {
		var option = document.createElement("option");
		option.value = availableRadiusServers[i].index;
		option.text = "IP:" + availableRadiusServers[i].ip + ", Port:" + availableRadiusServers[i].port;
		document.forms[0].auth_server_1.add(option);
		
		if (radiusServerIndex == option.value)
			selectIndex = i+1;
	}
	document.forms[0].auth_server_1.selectedIndex = selectIndex;

	selectIndex = 0;
	for (var i=0; i<availableInterfaces.length; i++) {
		var option = document.createElement("option");
		option.value = availableInterfaces[i];
		option.text = option.value;
		document.forms[0].interfaceName.add(option);
		
		if (currentInterface == option.value)
			selectIndex = i;
	}
	document.forms[0].interfaceName.selectedIndex = selectIndex;
	
	selectIndex = 0;
	if (authenType == "WEP") {
		selectIndex = 3;
	} else if (authenType == "None") {
		selectIndex = 0;
	} else {
		selectIndex = 1;
	}
	
	document.forms[0].sWep.selectedIndex = selectIndex;
	checkDropDown();
	
	if (authenType == "WEP") {
		if (encryptType == "64")
			document.forms[0].current_key.value = "40 bits WEP Static Key (Key Index = 1)";
		else
			document.forms[0].current_key.value = "104 bits WEP Static Key (Key Index = 1)";
	} else if (authenType.indexOf("[WPA]") == 0) {
		document.forms[0].wpa2_policy.checked = false;
		showWPA2EncryptionBox();
		document.forms[0].wpa1_policy.checked = true;
		showWPA1EncryptionBox();
		if (encryptType == "aes") {
			document.forms[0].wpa1_aes_encryption.checked = true;
			document.forms[0].wpa1_tkip_encryption.checked = false;
		} else {
			document.forms[0].wpa1_aes_encryption.checked = false;
			document.forms[0].wpa1_tkip_encryption.checked = true;
		}
		
		if (authenType.indexOf("[Auth(PSK)]") >= 0) {
			document.forms[0].DOT1X.checked = false;
			document.forms[0].PSK.checked = true;
		} else {
			document.forms[0].PSK.checked = false;
			document.forms[0].DOT1X.checked = true;
		}
		
		pmfWithPskChecked();
		pskSecurityChecked();
		wpa1EncryptionChecked();
		
		document.forms[0].akm_psk_key.value = authenKey;
	} else if (authenType.indexOf("[WPA2]") == 0) {
		document.forms[0].wpa1_policy.checked = false;
		showWPA1EncryptionBox();
		document.forms[0].wpa2_policy.checked = true;
		showWPA2EncryptionBox();
		if (encryptType == "aes") {
			document.forms[0].wpa2_aes_encryption.checked = true;
			document.forms[0].wpa2_tkip_encryption.checked = false;
		} else {
			document.forms[0].wpa2_aes_encryption.checked = false;
			document.forms[0].wpa2_tkip_encryption.checked = true;
		}
		
		if (authenType.indexOf("[Auth(PSK)]") >= 0) {
			document.forms[0].DOT1X.checked = false;
			document.forms[0].PSK.checked = true;
		} else {
			document.forms[0].PSK.checked = false;
			document.forms[0].DOT1X.checked = true;
		}
		
		pmfWithPskChecked();
		pskSecurityChecked();
		wpa2EncryptionChecked();
		
		document.forms[0].akm_psk_key.value = authenKey;
	}
	
	document.forms[0].reap_switching.checked = isLocalSwitching;
	document.forms[0].reap_local_auth.checked = isLocalAuth;
	if (!isLocalSwitching)
		document.forms[0].reap_local_auth.disabled = true;
}

function submitTheDataForm() {
	debugMsg("<submitAction>");
	var noerror = true;
	if(thisFormAttrs != null)
		noerror = validateForm(document.forms[0],thisFormAttrs);
	if(noerror && businessLogicImplemented)
		noerror = validateBusinessLogic(document.forms[0].thisFormAttrs);
	if(noerror){
		document.forms[0].buttonClicked.value = SUBMIT_CLICKED;
		top.CHttpFormExtractor.clearKeyValues();
		top.CHttpFormExtractor.addKeyValue("buttonClicked", document.forms[0].buttonClicked.value);
		top.CHttpFormExtractor.addKeyValue("vap_profileName", document.forms[0].vap_profileName.value);
		top.CHttpFormExtractor.addKeyValue("vap_ssid", document.forms[0].vap_ssid.value);
		top.CHttpFormExtractor.addKeyValue("wlan_id", document.forms[0].vap_id.value);
		top.CHttpFormExtractor.addKeyValue("enabled", document.forms[0].vap_admin_status.checked ? "true" : "false");
		top.CHttpFormExtractor.addKeyValue("interface", document.forms[0].interfaceName.value);
		top.CHttpFormExtractor.addKeyValue("auth_server_1", document.forms[0].auth_server_1.value);
		
		var authen = document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].text;
		if (authen == 'None') {
			top.CHttpFormExtractor.addKeyValue("authen", 'None');
		} else if (authen == 'Static WEP') {
			top.CHttpFormExtractor.addKeyValue("authen", 'WEP');
			if (document.forms[0].key_size.value == 'not_set') {
				if (authenType != 'WEP') {
					alert('WEP Encryption Key is not set.');
					return false;
				}
				top.CHttpFormExtractor.addKeyValue("encryptType", encryptType);
				top.CHttpFormExtractor.addKeyValue("authenKey", authenKey);
			} else {
				if (document.forms[0].key_size.value == 'size_40')
					top.CHttpFormExtractor.addKeyValue("encryptType", '64');
				else
					top.CHttpFormExtractor.addKeyValue("encryptType", '128');
				top.CHttpFormExtractor.addKeyValue("authenKey", document.forms[0].wep_key.value);
			}
		} else if (authen == 'WPA+WPA2') {
			if (document.forms[0].wpa1_policy.checked) {
				authen = '[WPA]';
				if (document.forms[0].wpa1_aes_encryption.checked)
					top.CHttpFormExtractor.addKeyValue("encryptType", 'aes');
				else
					top.CHttpFormExtractor.addKeyValue("encryptType", 'tkip');
			} else {
				authen = '[WPA2]';
				if (document.forms[0].wpa2_aes_encryption.checked)
					top.CHttpFormExtractor.addKeyValue("encryptType", 'aes');
				else
					top.CHttpFormExtractor.addKeyValue("encryptType", 'tkip');
			}
			
			if (document.forms[0].PSK.checked) {
				authen += '[Auth(PSK)]';
				top.CHttpFormExtractor.addKeyValue("authenKey", document.forms[0].akm_psk_key.value);
			} else {
				authen += '[Auth(802.1X)]';
			}
			
			top.CHttpFormExtractor.addKeyValue("authen", authen);
		}
		
		top.CHttpFormExtractor.addKeyValue("reap_switching", document.forms[0].reap_switching.checked);
		top.CHttpFormExtractor.addKeyValue("reap_local_auth", document.forms[0].reap_local_auth.checked);
		
		document.forms[0].submit();
	}
	
	return false;   
}

function wpa1EncryptionChecked() {
	document.forms[0].wpa1_tkip_encryption.disabled = document.forms[0].wpa1_aes_encryption.checked;
	document.forms[0].wpa1_aes_encryption.disabled = document.forms[0].wpa1_tkip_encryption.checked;
}

function wpa2EncryptionChecked() {
	document.forms[0].wpa2_tkip_encryption.disabled = document.forms[0].wpa2_aes_encryption.checked;
	document.forms[0].wpa2_aes_encryption.disabled = document.forms[0].wpa2_tkip_encryption.checked;
}

</script>

<link rel="stylesheet" href="styles/HtmlTabContainer.css" type="text/css">



<!-- 
<script language="javascript" src="javascript/dojo/dojo.js"></script>
<script language="JavaScript" src="javascript/selectbox.js"></script>
<script language="javascript" src="javascript/popup.js"></script>
 -->
<!----  This file contains only javascript code used for wlan details page. (Could not put this in a seperate javascript file since this javascript code contains EMWEB tags)----->
<script language="javascript">


window.onerror = null;
var numAttrs = new Array();

numAttrs[3] = new numberAttr("reassocTime","Reassociation Time",1,100,20,true);
numAttrs[4] = new numberAttr("comebacktimer","Comeback timer",1,10,null,true);
numAttrs[5] = new numberAttr("retrytimeout","SA Query Timeout",100,500,null,true);

/*
dojo.require("dojo.widget.TabContainer");
dojo.require("dojo.widget.LinkPane");
dojo.require("dojo.widget.ContentPane");
dojo.require("dojo.widget.LayoutContainer");
dojo.addOnLoad(onloadEvent);*/
var configured_session_timeout;
var configured_wpa1_aes_encryption;
var configured_wpa1_tkip_encryption;
var configured_wpa2_aes_encryption;
var configured_wpa2_tkip_encryption;
var loadBalCheckBoxValOnLoad;
var bandSelCheckBoxValOnLoad;
var universalAdminCheckBoxOnLoad;
var configured_vap_ssid;
var configured_vap_web_auth;
var configured_vap_local_auth;
var configured_tunnel_profile;

function onloadEvent(){
storeOriginalValues();showElementsIdleTimeout();showElements5();showElements7(); 
showVapSessionTimeOut(false);setAccountingState();setAuthenticatingState();
ogc_checked();create_dropdown();show128Warn();
recordInitialValues();

avc_assoc();


showMulticastInterface();pskSecurityChecked();
showElements6();showElementsWeb();enableQotdServer();checkDropDown();checkDropDown2();w11PFMcheckDropDown2();
showWPA1EncryptionBox(); showWPA2EncryptionBox();ft_show();macDot1xEnable(); 
displayProfile();enableLocalSwitchingParameters();hideSnooping();prioFunc();
enableLocalAuthParameters();nacHreapAndAaa();showHttpTimeOut();setRadiusIntPriority();diagChannelChecked();


showInterimInterval();
displayBonjour();
sptCheckBox();
sptOverrideCheckBox();
showSleepingTimeout();
OnChangePMFDropDown();
dot1xFlagSet();
	
showEapParams();allowEapParams();

CheckError();
}


function ft_show() {
    if(document.forms[0].ft.checked==true){
        document.getElementById("ft_box1").style.display="";
    }else{
        document.getElementById("ft_box1").style.display="none";
    }

}

function ftDisable() {

    document.getElementById('ft_box').style.display = 'none';
    document.getElementById('ft_box1').style.display = 'none';
    document.forms[0].overDs.checked = false;
    document.forms[0].ft.checked = false;
    document.forms[0].FT_DOT1X.checked = false;
    document.forms[0].FT_PSK.checked = false;

}


function storeOriginalValues()
{
	configured_session_timeout= document.forms[0].vap_session_timeout.value;
	configured_vap_ssid = document.forms[0].vap_ssid.value;

    configured_wpa1_aes_encryption = document.forms[0].wpa1_aes_encryption.checked;
    configured_wpa1_tkip_encryption = document.forms[0].wpa1_tkip_encryption.checked;
    configured_wpa2_aes_encryption = document.forms[0].wpa2_aes_encryption.checked;
    configured_wpa2_tkip_encryption = document.forms[0].wpa2_tkip_encryption.checked;
    if (document.forms[0].sIPsec.options[document.forms[0].sIPsec.selectedIndex].value == "security_web") {
           configured_vap_web_auth = document.forms[0].security_web_options[0].checked;
    }      
    else {
       configured_vap_web_auth= false;
    }   
    configured_vap_local_auth = document.forms[0].reap_local_auth.checked;
    configured_tunnel_profile = document.forms[0].tunnel_profile.options[document.forms[0].tunnel_profile.selectedIndex].value;


}
function w11PFMcheckDropDown() {

    var field;
    field = document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value;

    switch(field) {
        case "DISABLE":
            document.getElementById("w11akm").style.display ="none";
            document.getElementById("w11akmtime").style.display ="none";
            break;
        case "OPTIONAL":
            document.getElementById("w11akm").style.display ="inline";
            document.getElementById("w11akmtime").style.display ="inline";
            document.forms[0].w11.checked = false;
            alert("Warning: PMF AKMs shall not be advertised in beacons/probes with PMF as optional.");
            break;
        case "REQUIRED":
            document.getElementById("w11akm").style.display ="inline";
            document.getElementById("w11akmtime").style.display ="inline";
            document.forms[0].w11.checked = true;
            document.forms[0].DOT1X.checked = false;
            break;
        default:
            break;
    }
    
}

function OnChangePMFDropDown()
{

  if (document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value == "REQUIRED")
  {	  
    document.forms[0].DOT1X.checked = false;
    document.forms[0].DOT1X.disabled = true;
    document.forms[0].CCKM.checked = false;
    document.forms[0].CCKM.disabled = true;
    document.forms[0].PSK.checked = false;
    document.forms[0].PSK.disabled = true;
    document.forms[0].FT_PSK.checked = false;
    document.forms[0].FT_PSK.disabled = true;
    document.forms[0].FT_DOT1X.checked = false;
    document.forms[0].FT_DOT1X.disabled = true;
  }
  else
  {
    document.forms[0].DOT1X.disabled = true;
    document.forms[0].CCKM.disabled = true;
    document.forms[0].PSK.disabled = false;
    document.forms[0].FT_PSK.disabled = true;
    document.forms[0].FT_DOT1X.disabled = true;
    pskSecurityChecked();
  }

}
function w11PFMcheckDropDown2() {

    var field;
    field = document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value;

    switch(field) {
        case "DISABLE":
            document.getElementById("w11akm").style.display ="none";
            document.getElementById("w11akmtime").style.display ="none";
            break;
        case "OPTIONAL":
            document.getElementById("w11akm").style.display ="inline";
            document.getElementById("w11akmtime").style.display ="inline";
            break;
        case "REQUIRED":
            document.getElementById("w11akm").style.display ="inline";
            document.getElementById("w11akmtime").style.display ="inline";
            break;
        default:
            break;
    }

}
function sptCheckBox() {

    if(document.forms[0].sptmode.checked) {
        document.getElementById('spt_override_field').style.display='block';
        document.getElementById('spt_acl_field').style.display='block';
    }
    else {
        document.getElementById('spt_override_field').style.display='none';
        document.getElementById('gw_mask_field').style.display='none';
        document.getElementById('spt_acl_field').style.display='none';
    }

}

function sptOverrideCheckBox() {

    if(document.forms[0].sptVapOverride.checked) 
        document.getElementById('gw_mask_field').style.display='block';
    else  
        document.getElementById('gw_mask_field').style.display='none';

}

function checkDropDown() {

	var field;
	field = document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value;
	switch(field) {
		case "wep_none":
		 	document.getElementById('wep_param_table').style.display =  'none';
			document.getElementById('ckip_param_table').style.display = 'none';
			document.getElementById('x8021_param_table').style.display = 'none';
			document.getElementById('WPA1WPA2_param_table').style.display = 'none';
			document.getElementById('eap_msg').style.display = 'none';
			document.getElementById('mac_box').style.display = 'none';
            document.getElementById('w11PFM_Dropdown').style.display = 'none';
                        document.getElementById("w11akmtime").style.display ="none";
                        document.getElementById('ft_box').style.display = 'inline';

    if(document.forms[0].FT_DOT1X.checked == true || document.forms[0].FT_PSK.checked ==true) {   
                        document.forms[0].FT_DOT1X.checked = false;
                        document.forms[0].FT_PSK.checked = false;
           }

			break;


		case "wep_static":
		 	document.getElementById('wep_param_table').style.display =  'inline';
			document.getElementById('ckip_param_table').style.display = 'none';
			document.getElementById('x8021_param_table').style.display = 'none';
			document.getElementById('WPA1WPA2_param_table').style.display = 'none';
			document.getElementById('eap_msg').style.display = 'none';
			document.getElementById('mac_box').style.display = 'none';
            document.getElementById('w11PFM_Dropdown').style.display = 'none';
                        document.getElementById("w11akmtime").style.display ="none"; 
                        ftDisable();
			changeWepKeyDisplay();
			break;
		case "wep_ckip":
			document.forms[0].sWep.selectedIndex = 0;
			notSupported();
			return;
		 	document.getElementById('wep_param_table').style.display =  'none';
			document.getElementById('ckip_param_table').style.display = 'inline';
			document.getElementById('x8021_param_table').style.display = 'none';
			document.getElementById('WPA1WPA2_param_table').style.display = 'none';
			document.getElementById('eap_msg').style.display = 'none';
			document.getElementById('mac_box').style.display = 'none';
            document.getElementById('w11PFM_Dropdown').style.display = 'none';
                        document.getElementById("w11akmtime").style.display ="none";
                        ftDisable();
			changeCkipKeyDisplay();
			break;
		case "wep_8021x":
			document.forms[0].sWep.selectedIndex = 0;
			notSupported();
			return;
		 	document.getElementById('wep_param_table').style.display =  'none';
			document.getElementById('ckip_param_table').style.display = 'none';
			document.getElementById('x8021_param_table').style.display = 'inline';
			document.getElementById('WPA1WPA2_param_table').style.display = 'none';
			document.getElementById('eap_msg').style.display = 'none';
			document.getElementById('mac_box').style.display = 'none';
                        document.getElementById('w11PFM_Dropdown').style.display = 'none';
                        document.getElementById("w11akmtime").style.display ="none";
                        ftDisable();
			wepKeySize8021xSelection();
			break;
		case "wep_static_8021x":
			document.forms[0].sWep.selectedIndex = 0;
			notSupported();
			return;
		 	document.getElementById('wep_param_table').style.display =  'inline';
			document.getElementById('ckip_param_table').style.display = 'none';
			document.getElementById('x8021_param_table').style.display = 'inline';
			document.getElementById('WPA1WPA2_param_table').style.display = 'none';
			document.getElementById('eap_msg').style.display = 'none';
			document.getElementById('mac_box').style.display = 'block';
            document.getElementById('w11PFM_Dropdown').style.display = 'none';
                        document.getElementById("w11akmtime").style.display ="none";
                        ftDisable();
			changeWepKeyDisplay();
			break;
		case "wep_wpa1wpa2":
		 	document.getElementById('wep_param_table').style.display =  'none';
			document.getElementById('ckip_param_table').style.display = 'none';
			document.getElementById('x8021_param_table').style.display = 'none';
			document.getElementById('WPA1WPA2_param_table').style.display = 'inline';
			document.getElementById('eap_msg').style.display = 'none';
			document.getElementById('mac_box').style.display = 'none';
            document.getElementById('w11PFM_Dropdown').style.display = 'inline';
                        w11PFMcheckDropDown2();
                        if (document.forms[0].wpa2_policy.checked == false)                              ftDisable();

			break;
                case "eap_passthru":
						document.forms[0].sWep.selectedIndex = 0;
						notSupported();
						return;
                        document.getElementById('wep_param_table').style.display =  'none';
                        document.getElementById('ckip_param_table').style.display = 'none';
                        document.getElementById('x8021_param_table').style.display = 'none';
                        document.getElementById('WPA1WPA2_param_table').style.display = 'none';
                        document.getElementById('eap_msg').style.display = 'inline';
                        document.getElementById('mac_box').style.display = 'none';
                        document.getElementById('w11PFM_Dropdown').style.display = 'none';
                        document.getElementById("w11akmtime").style.display ="none";
                        ftDisable();
			break;

		default:
			break;
	}

}


//show vap session timeout field
//if flag is true that means - set the default value for session timeout
function showVapSessionTimeOut(flag)
{
    if(document.forms[0].vap_session_timeout_chkbx.checked == true)
    {
        document.getElementById('vap_session_id').style.display = 'inline';
        if(flag == true){
          setSessionTimeout();
        }
        else{
            setSessionTimeoutRange()
        }

    }
    else{
        document.getElementById('vap_session_id').style.display = 'none';
        numAttrs[0]=null;
    }
}

function showInterimInterval() 
{
  if(document.forms[0].interim_update.checked == true)  
        document.getElementById('interim_interval_div').style.display = ''; 
  else
        document.getElementById('interim_interval_div').style.display = 'none';
}



function avc_assoc()
{
  if(document.forms[0].avcprofile.value == 'none')
    {
      document.getElementById('nbarEnabled').disabled = true;
    }
  else
    {
      document.getElementById('nbarEnabled').disabled = true;
    }
}



function showMulticastInterface() 
{
if(document.forms[0].multicast_vlan.checked == true)
        document.getElementById('multicastIntf').style.display = '';
else
        document.getElementById('multicastIntf').style.display = 'none';
}


//for non psk session time out is 300-86400
//for 802.1x session timeout is 0-65535
function setSessionTimeoutRange()
{

	var index=document.forms[0].sWep.selectedIndex;
	var l2Security = document.forms[0].sWep.options[index].value;
	if ( (l2Security == "wep_8021x") ||
		 (l2Security == "wep_static_8021x"))
	{
		  numAttrs[0] = new numberAttr("vap_session_timeout",
				              "Session Timeout (secs)",300,86400,null,true);
    }
	else if ( l2Security == "wep_wpa1wpa2"){
		//check auth mgmt
		if(document.forms[0].PSK.checked == true || document.forms[0].FT_PSK.checked == true || document.forms[0].w11Psk.checked == true) {
		   numAttrs[0] = new numberAttr("vap_session_timeout",
				           "Session Timeout (secs)",0,65535,null,true);
		}
		else{
		  numAttrs[0] = new numberAttr("vap_session_timeout",
				              "Session Timeout (secs)",300,86400,null,true);
		}
	}
    else{


		numAttrs[0] = new numberAttr("vap_session_timeout",
			           "Session Timeout (secs)",0,65535,null,true);

    }

}

//for non psk session time out is 300-86400
//for psk session timeout is 0-65535
//if configured_session_timeout is > 0 then set it back to same value for 802.1x securities
function setSessionTimeout(){

	var index=document.forms[0].sWep.selectedIndex;
	var l2Security = document.forms[0].sWep.options[index].value;
	if ( (l2Security == "wep_8021x") ||
		 (l2Security == "wep_static_8021x"))
	{
		document.forms[0].vap_session_timeout.value = 
			(configured_session_timeout > 0 ?configured_session_timeout:1800);
    }
	else if ( l2Security == "wep_wpa1wpa2"){
		//check auth mgmt
		if(document.forms[0].PSK.checked == true || document.forms[0].FT_PSK.checked == true) {
		   document.forms[0].vap_session_timeout.value = 
			(configured_session_timeout > 0 ?configured_session_timeout:0);
		}
		else{
		   document.forms[0].vap_session_timeout.value = 
			         (configured_session_timeout > 0?configured_session_timeout:1800);
		}
	}   
    else{
		   document.forms[0].vap_session_timeout.value = 
			(configured_session_timeout > 0 ?configured_session_timeout:0);
    }


	setSessionTimeoutRange();
}

function checkDropDown2() {


	var field;
	var timeout;
	field = document.forms[0].sIPsec.options[document.forms[0].sIPsec.selectedIndex].value;
	switch(field) {
		case "vpn_none":

			document.getElementById('ipsec_param_table').style.display = 'none';
			document.getElementById('l2tp_param_table').style.display = 'none';
			timeout = document.forms[0].vap_timeout_value.value;
			if(timeout == "" || timeout < 1800)
			document.forms[0].vap_timeout_value.value = "57600";


         	//	document.forms[0].sIPsec.value = "security_web";
			break;
              case "security_web":

                      document.getElementById('ipsec_param_table').style.display = 'none';
                      document.getElementById('l2tp_param_table').style.display = 'none';

                      break;

	
         	case "vpn_ipsec":
		 	document.getElementById('ipsec_param_table').style.display = 'inline';

			document.getElementById('l2tp_param_table').style.display = 'none';
			document.forms[0].sIPsec.value = "security_web";
            showElements6();
            showElementsWeb();
			document.forms[0].sIPsec.value = "vpn_none";
			break;
		/*
		case "vpn_l2tp":
		 	ipsec_param_table.className ="invisible";

		 	l2tp_param_table.className ="";
			document.forms[0].sIPsec.value = security_web;
            showElements6();
            showElementsWeb();
			document.forms[0].sIPsec.value = "vpn_none";
			break;
		*/


		default:
			break;
	}

}

function changeDefaults(){
	var field;
	var timeout;
	field = document.forms[0].sIPsec.options[document.forms[0].sIPsec.selectedIndex].value;
	switch(field) {
		case "vpn_ipsec":
            document.forms[0].vap_vpn_auth.selectedIndex = 1;
			break;
	    /*
		case "vpn_l2tp":
            document.forms[0].l2tp_vap_vpn_auth.selectedIndex = 0;
            document.forms[0].vap_dhcp_required.checked = true;
            break;
		*/
        default:

    }
}

var oldAdminStatus = false; // This is need to figure out if user enables wlan from a disabled state
                            // or was it already enabled to show proper warning msg. Bug #7473
function showElements5() {
    oldAdminStatus = document.forms[0].vap_admin_status.checked;

	if (document.forms[0].vap_blacklist.checked == false){
          document.forms[0].vap_blacklist_timeout.value = "";
   	  //if(navigator.appName == "Netscape") return;
 		document.getElementById('blacklist_id_box').style.display = 'none';
		//blacklist_id_box.className ="visioff";
        }
 	else{
	        //if(navigator.appName == "Netscape") return;
 		//blacklist_id_box.className = "";
		document.getElementById('blacklist_id_box').style.display = 'inline';
        }

}

function showSleepingTimeout() {

       if (document.forms[0].sleep_client.checked == true) {
           document.getElementById("select_sleeptime").style.display ="inline";
       }
       else  {
           document.getElementById("select_sleeptime").style.display ="none";
       }

}

function showElementsIdleTimeout() {

   if (document.forms[0].user_idle_timeout_chbx.checked == false){
         //document.forms[0].clients_user_idle_timeout.value = "0";
       document.getElementById('idletimeout_id_box').style.display = 'none';
         }
   else{
       document.getElementById('idletimeout_id_box').style.display = 'inline';
         }

}


function showElementsWeb() {
     var temp = document.forms[0].sIPsec;
     var selectedVal = temp.options[temp.selectedIndex].value;
     if (selectedVal=="security_web"){    
        document.getElementById("select_acl").style.display ="inline";
        if (document.forms[0].security_web_options[1].checked == true ||
            document.forms[0].security_web_options[0].checked == true ||
            document.forms[0].security_web_options[4].checked == true) {
            document.getElementById("select_emailinput").style.display ="none";
  
            document.getElementById("select_sleepclient").style.display ="block";
            if (document.forms[0].sleep_client.checked == true) {
                document.getElementById("select_sleeptime").style.display ="block";
            }
            else  {
                document.getElementById("select_sleeptime").style.display ="none";
            }

            
            document.getElementById("select_ogcenable").style.display ="block";
             <!-- NOT SMB -->
            if (document.forms[0].security_web_options[1].checked == true) {
                document.getElementById("select_emailinput").style.display ="block";
            }
            
            if (document.forms[0].Over_ride_global_config.checked == true) {
                document.getElementById("select_ogc").style.display ="block";
                create_dropdown();
            }    
            else {
                document.getElementById("select_ogc").style.display ="none";
                document.getElementById('login_page').style.display ="none";
                document.getElementById('logout_page').style.display ="none";
                document.getElementById('login_failure_page').style.display ="none";
                document.getElementById('url_id').style.display ="none";
            }
             <!-- NOT SMB -->
        }
        else {
            document.getElementById("select_ogc").style.display ="none";
            document.getElementById("select_ogcenable").style.display ="none";
            document.getElementById("select_emailinput").style.display ="none";
            document.getElementById('login_page').style.display ="none";
            document.getElementById('logout_page').style.display ="none";
            document.getElementById('login_failure_page').style.display ="none";
            document.getElementById('url_id').style.display ="none";

            document.getElementById("select_sleepclient").style.display ="none";
            document.getElementById("select_sleeptime").style.display ="none";

        }
    } 
    else if (selectedVal!="security_web"){
        showElements6();
        document.getElementById("select_acl").style.display ="none";
        document.getElementById("select_ogc").style.display ="none";
        
        document.getElementById("select_ogcenable").style.display ="none";
        
        document.getElementById("select_emailinput").style.display ="none";
        document.getElementById('login_page').style.display ="none";
        document.getElementById('logout_page').style.display ="none";
        document.getElementById('login_failure_page').style.display ="none";
        document.getElementById('url_id').style.display ="none";
    }
}

function showElements6(){
     var temp = document.forms[0].sIPsec;
     var selectedVal = temp.options[temp.selectedIndex].value;
     if (selectedVal=="security_web"){
 		  document.getElementById("select_web_options").style.display ="block";
    }else if (selectedVal!="security_web"){
 		  document.getElementById("select_web_options").style.display ="none";
    }
}

function security_web_checked(){
     var temp = document.forms[0].sIPsec;
     var selectedVal = temp.options[temp.selectedIndex].value;
     if (selectedVal=="security_web"){
 		  document.getElementById("select_web_options").style.display ="block";
		  alert("The controller will forward DNS traffic to and from wireless clients prior to authentication in absence of explicit deny rule for DNS traffic in Pre-Auth ACL.");
    }else if (selectedVal!="security_web"){
 		  document.getElementById("select_web_options").style.display ="none";
    }
	showElementsWeb();
}

function ogc_checked(){

    document.getElementById("select_ogc").style.display ="none";
    if (document.forms[0].Over_ride_global_config.checked == true) {
        document.getElementById("select_ogc").style.display ="block";
        create_dropdown();
    } else {
        document.getElementById('login_page').style.display ="none";
        document.getElementById('login_failure_page').style.display ="none";
        document.getElementById('logout_page').style.display ="none";
	document.getElementById('url_id').style.display ="none";
 	document.getElementById("select_ogc").style.display ="none";
    }


    showElementsWeb();

}
  	 
function create_dropdown() {
    if(document.getElementById('webauthtypeid').value == 'Internal') {
        document.getElementById('login_page').style.display ="none";
        document.getElementById('logout_page').style.display ="none";
        document.getElementById('login_failure_page').style.display ="none";
        document.getElementById('url_id').style.display ="none";
    }
    else if(document.getElementById('webauthtypeid').value == 'Customized') {
        document.getElementById('login_page').style.display ="block";
        document.getElementById('logout_page').style.display ="block";
        document.getElementById('login_failure_page').style.display ="block";
        document.getElementById('url_id').style.display ="none";
    }
    else if(document.getElementById('webauthtypeid').value == 'External') {
        document.getElementById('login_page').style.display ="none";
        document.getElementById('logout_page').style.display ="none";
        document.getElementById('login_failure_page').style.display ="none";
        document.getElementById('url_id').style.display ="block";
    }

}

function showElements7() {

	if (document.forms[0].vap_dhcp_override.checked == false){
          document.forms[0].vap_dhcpIp.value = "0.0.0.0";
        document.getElementById("dhcp_server_box").style.display ="none";
        //document.getElementById("dhcp_server_req").style.display ="none";
        //document.forms[0].vap_dhcp_required.checked = false;
    }
 	else{
 		document.getElementById("dhcp_server_box").style.display ="block";
        //document.getElementById("dhcp_server_req").style.display ="block";
    }
/*

        if (document.forms[0].vap_dhcpv6_override.checked == false){
          document.forms[0].vap_dhcpIpv6.value = "::";
        document.getElementById("dhcp_serverv6_box").style.display ="none";
    }
        else{
                document.getElementById("dhcp_serverv6_box").style.display ="block";
    }

*/
}

function dhcpAlert() {

        if (document.forms[0].vap_dhcp_override.checked == true )
                alert("DHCP server override is applicable only to the default AP group.");
}

function showElements8_forWired() {
    document.getElementById("select_acl").style.display ="block";
    document.getElementById("select_emailinput").style.display ="none";
    document.getElementById("select_ogcenable").style.display ="block";
    if (document.forms[0].Over_ride_global_config.checked == true) {
        document.getElementById("select_ogc").style.display ="block";
        create_dropdown();
    } 
    if (document.forms[0].layer3_sec.options[document.forms[0].layer3_sec.selectedIndex].value == "web_passthrough") {
        document.getElementById("select_emailinput").style.display ="block";

        document.getElementById("select_sleepclient").style.display ="block";
        if (document.forms[0].sleep_client.checked == true) {
            document.getElementById("select_sleeptime").style.display ="block";
        }
        else  {
            document.getElementById("select_sleeptime").style.display ="none";
        }

    }
    else {
        document.getElementById("select_emailinput").style.display ="none";
    }
    if (document.forms[0].layer3_sec.options[document.forms[0].layer3_sec.selectedIndex].value == "webOpenAuth") {
        document.getElementById("select_ogcenable").style.display = "none";
        document.getElementById("select_ogc").style.display = "none";
        document.getElementById('login_page').style.display ="none";
        document.getElementById('logout_page').style.display ="none";
        document.getElementById('login_failure_page').style.display ="none";
        document.getElementById('url_id').style.display ="none";

        document.getElementById("select_sleepclient").style.display ="none";
        document.getElementById("select_sleeptime").style.display ="none";

    }
}

function showWPA1EncryptionBox(){
    var l2sec = document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value;
    if (l2sec == "wep_wpa1wpa2") {
        if (document.forms[0].wpa1_policy.checked == false){
			document.forms[0].wpa2_policy.disabled = false;
              document.forms[0].wpa1_aes_encryption.checked = false;
              document.forms[0].wpa1_tkip_encryption.checked = false;
              document.getElementById("wpa1_encr_box").style.display ="none";
        }
        else{
			document.forms[0].wpa2_policy.disabled = true;
              document.forms[0].wpa1_aes_encryption.checked = configured_wpa1_aes_encryption;
              document.forms[0].wpa1_tkip_encryption.checked = configured_wpa1_tkip_encryption;
              document.getElementById("wpa1_encr_box").style.display ="block";
			wpa1EncryptionChecked();
        }
    }
}

function showWPA2EncryptionBox(){
    var l2sec = document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value;
    if (l2sec == "wep_wpa1wpa2") {
        if (document.forms[0].wpa2_policy.checked == false){
			document.forms[0].wpa1_policy.disabled = false;
            document.forms[0].wpa2_aes_encryption.checked = false;
            document.forms[0].wpa2_tkip_encryption.checked = false;
            document.getElementById("wpa2_encr_box").style.display ="none";
            document.getElementById("ft_akm").style.display ="none";
            document.getElementById("ft_box").style.display ="none";
            document.getElementById("ft_box1").style.display ="none";
            document.getElementById("w11PFM_Dropdown").style.display="none";
            document.getElementById("w11akmtime").style.display="none";
        } else{
			document.forms[0].wpa1_policy.disabled = true;
            document.forms[0].wpa2_aes_encryption.checked = configured_wpa2_aes_encryption;
            document.forms[0].wpa2_tkip_encryption.checked = configured_wpa2_tkip_encryption;
            document.getElementById("wpa2_encr_box").style.display ="block";
            document.getElementById("ft_akm").style.display ="block";
            document.getElementById("ft_box").style.display ="block";
            ft_show();
            Pmfreqenable();
			wpa2EncryptionChecked();
        }
    }
}

function showFtCfg(flag){
}

function cckmSecurityChecked(){
  if (document.forms[0].CCKM.checked == true){
    document.forms[0].PSK.checked = false;
    document.forms[0].PSK.disabled = true;
    document.forms[0].FT_PSK.checked = false;
    document.forms[0].FT_PSK.disabled = true;
    document.forms[0].w11Psk.checked = false;
    document.forms[0].w11Psk.disabled = true;
  } else {
     document.forms[0].PSK.disabled = false;
     document.forms[0].FT_PSK.disabled = true;
     document.forms[0].w11Psk.disabled = false;
  }

}

function ftSecurityChecked(){
  if ((document.forms[0].FT_DOT1X.checked == true) || (document.forms[0].FT_PSK.checked == true)) {
     alert("Warning!! Non-802.11r Clients may not join on this WLAN");
   }

  if ((document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value == "REQUIRED")||
      (document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value == "OPTIONAL"))
  {
     if (document.forms[0].FT_DOT1X.checked == true)
     {	     
         document.forms[0].w11.checked = true;
     }	
     else
     {	     
         document.forms[0].w11.checked = false;
     }
     if ((document.forms[0].FT_PSK.checked == true) || (document.forms[0].PSK.checked == true))
     {
         document.forms[0].w11Psk.checked = true;
     }
     else
     {
         document.forms[0].w11Psk.checked = false;
     }	 
  } 

}

function pskSecurityChecked(){

  if (document.forms[0].PSK.checked == false && document.forms[0].FT_PSK.checked == false && document.forms[0].w11Psk.checked == false){
    document.forms[0].CCKM.disabled = true;
    document.forms[0].DOT1X.disabled = false;
    document.forms[0].FT_DOT1X.disabled = true;
    document.forms[0].w11.disabled = true;
    document.getElementById("wpa_key_mgmt_psk_box").style.display ="none";
  } else{
    document.forms[0].CCKM.checked = false;
    document.forms[0].CCKM.disabled = true;
    document.forms[0].DOT1X.checked = false;
    document.forms[0].DOT1X.disabled = true;
    document.forms[0].FT_DOT1X.checked = false;
    document.forms[0].FT_DOT1X.disabled = true;
    document.forms[0].w11.checked = false;
    document.forms[0].w11.disabled = true;
    document.getElementById("wpa_key_mgmt_psk_box").style.display ="block";
  }
    showVapSessionTimeOut(true);
    if ( document.forms[0].PSK.checked == true || document.forms[0].FT_PSK.checked == true || document.forms[0].w11Psk.checked == true){
       if( document.forms[0].dot1xflag.value == 1) {
           document.forms[0].vap_session_timeout.value = 0; 
           document.forms[0].dot1xflag.value = 0;
       }	   
    }
}


function pmfwithpmfpskChecked(){

  if ((document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value == "REQUIRED") && (document.forms[0].w11Psk.checked == false))
  {
     document.forms[0].CCKM.disabled = true;
     document.forms[0].DOT1X.disabled = true;
     document.forms[0].FT_DOT1X.disabled = true;

  }	  
}	  
function pmfWithPskChecked(){

  if ((document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value == "REQUIRED")||
      (document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value == "OPTIONAL"))
  {
     if ((document.forms[0].PSK.checked == true) || (document.forms[0].FT_PSK.checked == true)) 
     {		     
          document.forms[0].w11Psk.checked = true;
     }	  
     else
     {
          document.forms[0].w11Psk.checked = false;
     }

  }  
}

function enableQotdServer(){

	if (document.forms[0].vap_qotd_mode.checked == false){
          document.getElementById("qotd_server_box").style.display ="none";
    }
 	else{
          document.getElementById("qotd_server_box").style.display ="block";
    }

}




  
    numAttrs[1] = new numberAttr("vap_blacklist_timeout","Client Exclusion Timeout",
		             0,2147483647,null,false);
   

var ipAttrs = new Array();
var ii = 0;

  
     
      ipAttrs[ii++] = new ipAttr("vap_qotd_addr","QOTD Server Address",null,false);
    
    
  

/* Begin For Bug #2396 */
var textAttrs = new Array();
//if(document.forms[0].sIPsec.options[document.forms[0].sIPsec.selectedIndex].value == "vpn_ipsec" &&
//   document.forms[0].vap_vpn_ike_auth[1].checked == true)


   textAttrs[0] = new textAttr("preshared_key","Pre Shared Key",128,null,null,false);
   textAttrs[1] = new textAttr("l2tp_preshared_key","Pre Shared Key",128,null,null,false);





// add validation for dtim fields.
// Remove validation for 802.11a dtim period as SMB supports only 802.11b/g

  numAttrs.push(new numberAttr("dtim_period11a","DTIM Period: 802.11a/n",
                 1,255,null,false));

  numAttrs.push(new numberAttr("dtim_period11b","DTIM Period: 802.11b/g/n",
                 1,255,null,false));




  numAttrs.push(new numberAttr("scan_defer_time","Scan Defer Time",
                0,60000,null,false));

numAttrs.push(new numberAttr("max_clients","Maximum Allowed Clients",
                0, 1000,null,false));
numAttrs.push(new numberAttr("interim_interval","Interim Interval",
                0, 3600,null,false));

numAttrs.push(new numberAttr("max_clients_radio","Maximum Allowed Clients Per AP Radio",
                1, 200,null,true));
numAttrs.push(new numberAttr("clients_user_idle_timeout","Client user idle timeout", 15, 100000,null,true));
numAttrs.push(new numberAttr("clients_user_idle_threshold","Client user idle threshold", 0, 10000000,null,true));
<!-- numAttrs.push(new numberAttr("http_timeout","HTTP Timeout",0,65535,null,false)); -->

numAttrs.push(new numberAttr("sleep_timeout","Sleeping client timeout value", 10,43200,null,true));
numAttrs.push(new numberAttr("eap_timeout","EAPOL Key Timeout", 200,5000,1000,true));
numAttrs.push(new numberAttr("eap_retries","EAPOL Key Retries", 0,4,2,true));
numAttrs.push(new numberAttr("identity_timeout","Identity Request Timeout", 1,120,30,true));
numAttrs.push(new numberAttr("identity_retries","Identity Request Retries", 1,20,2,true));
numAttrs.push(new numberAttr("req_timeout","Request Timeout", 1,120,30,true));
numAttrs.push(new numberAttr("req_retries","Request Retries", 1,20,2,true));


thisFormAttrs = new formAttrs(numAttrs,textAttrs,ipAttrs,null);

function recordInitialValues() {

    prevQos = document.forms[0].vap_qos.options[document.forms[0].vap_qos.selectedIndex].value;

    loadBalCheckBoxValOnLoad = document.forms[0].load_bal.checked;
    bandSelCheckBoxValOnLoad = document.forms[0].band_select.checked;
    universalAdminCheckBoxOnLoad = document.forms[0].universal_admin.checked;


}

businessLogicImplemented = true;
function validateBusinessLogic(attrs){
    var errDisplayMsg = "";


    getPrtyOrder(document.forms[0].auth_prty2a);
    var val = document.forms[0].mgmt_prtyOrder2.value;

    if(document.forms[0].vap_blacklist.checked){
    if(document.forms[0].vap_blacklist_timeout.value == ""){
        alert("If you enable Client Exclusion you have to specify a timeout value");
        return false;
    }
    }


   var temp = document.forms[0].sIPsec;
   var selectedVal = temp.options[temp.selectedIndex].value;
   if(document.forms[0].mac_filtering.checked == false){
      if((selectedVal=="security_web") && document.forms[0].security_web_options[4].checked){
         alert("Cannot enable web policy-On MAC Filter failure. MAC filter on wlan is not enabled.");
         return false;
      }
   }


//Added by jjain, Ref Bug # 4485

 if(document.forms[0].vap_dhcp_override.checked){
   if(document.forms[0].vap_dhcpIp.value == "" || document.forms[0].vap_dhcpIp.value == "0.0.0.0"){
     alert("Please specify a valid DHCP Server IP Address");
     return false;
   }
 }
 /* commented for 8.0 release
 if(document.forms[0].vap_dhcpv6_override.checked){
   if(document.forms[0].vap_dhcpIpv6.value == "" || document.forms[0].vap_dhcpIpv6.value == "::"){
     alert("Please specify a valid DHCP Server IP Address");
     return false;
   }
 }
 */



 if(document.forms[0].current_key.value == "None" && document.forms[0].vap_admin_status.checked){                        
   if(document.forms[0].sWep.value == "wep_static" && document.forms[0].key_size.value == "not_set"){                 
     alert("Static wep-key is not configured");
     return false;
   }
 }




// Cranite or Fortress is configuration and DHCP-required configuration cannot coexist.
 if(document.forms[0].vap_dhcp_required.checked){
	var temp = document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value;
	if ( 


			false ) {
		alert("Cannot simultaneously enable DHCP requirement and configure Cranite option for Layer-2 security.");
		return false;
	}
 }


       temp = document.forms[0].vap_qos.options[document.forms[0].vap_qos.selectedIndex].value;

       if (document.forms[0].diag_cha.checked == false)
       {
         if (document.forms[0].voip_call_failure.checked)
         {
            if (temp != "Platinum" && temp != "Gold")
            {
              errDisplayMsg +=  "Media Session Snooping is supported only for Platinum or Gold Qos profiles. ";
            }
         }
       }
       if(document.forms[0].kts_cac_support.checked){
           temp = document.forms[0].vap_qos.options[document.forms[0].vap_qos.selectedIndex].value;
           if((temp != "Platinum") && (document.forms[0].reap_switching.checked == true))  {
               errDisplayMsg += "KTS based CAC policy is supported only for Platinum QoS profile and is not supported with FlexConnect Local Switching. ";
           }
           else {
               if(temp != "Platinum") 
                  errDisplayMsg += "KTS based CAC policy is supported only for Platinum QoS profile. ";
     
               if(document.forms[0].reap_switching.checked == true) 
                 errDisplayMsg += "KTS based CAC policy is not supported with FlexConnect Local Switching. ";
          }
     }  

    if(document.forms[0].FT_DOT1X.checked == true || document.forms[0].FT_PSK.checked ==true) {    if (document.forms[0].ft.checked == false) {
         alert("Cannot enable FT AKMs when Fast transition is disabled.");
         return false;
      }
   }

    if(document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value != "DISABLE")  {
  if(document.forms[0].w11.checked == false && document.forms[0].w11Psk.checked ==false) {
         alert("PMF AKMs are mandatory for enabling Protected Management Frame (PMF).");
         return false;
      }
   } else {
     document.forms[0].w11.checked =false;
     document.forms[0].w11Psk.checked = false;
   }
       

 
     if(errDisplayMsg != "")
     {
         errDisplayMsg += "Make the necessary changes and try again."
         alert(errDisplayMsg);
         return false;
     } 

       if ((document.forms[0].diag_cha.checked == true) && (document.forms[0].overwrite_int.checked == true))
       {
           alert("Radius Server Overwrite interface is not supported on Diagnostic Wlans.");
           return false;
       }





 if((document.forms[0].client_cac_limit.checked) 
    && (document.forms[0].vap_wme.value == "Allowed"
     || document.forms[0].vap_wme.value == "Required")){
     alert("7920 Phone Support with Client CAC Limit cannot be enabled when WMM Policy is enabled.");
     return false;
 }
 

 if(document.forms[0].sIPsec.options[document.forms[0].sIPsec.selectedIndex].value == "vpn_ipsec"){
    // if ipsec and selected Ike Auth is not Cert and admin status is enabled
    // then KeySize better be nonzero or propmt user to enter the key
    var keyNeeded = !(document.forms[0].vap_vpn_ike_auth[0].checked);
    var contivityChecked=document.forms[0].vap_qotd_mode.checked; 
    var oldKeySize = document.forms[0].ipsec_key_size.value;
    var newKeySize;
    if(keyNeeded && !contivityChecked){
        var adminEnabled = document.forms[0].vap_admin_status.checked;
        if(document.forms[0].vap_vpn_ike_auth[1].checked)
            newKeySize = document.forms[0].preshared_key.value.length;
        else if(document.forms[0].vap_vpn_ike_auth[2].checked)
            newKeySize = document.forms[0].XauthPsk_key.value.length;

        if(oldKeySize == 0 && newKeySize == 0 && adminEnabled){
            alert("For the chosen IKE Authentication mode for IPsec Security, Preshared Key is mandatory. Please specify it and then click Apply.");
            return false;
        }
        if((newKeySize == 0 && oldKeySize < 8) || (newKeySize > 0 && newKeySize < 8)){
            if( confirm("A Preshared Key length of less than 8 bytes will not interoperate with other vendor's VPN client. Are you sure you want to continue?") == false)
                return false;
        }
    }
    /* this means contivity is checked */
   if(contivityChecked){ 
    if(document.forms[0].vap_qotd_addr.value == ""){
        alert("Please specify a valid QOTD Server IP Address");
        return false;
     }
     //if L2tp with contivity is checked then
     // 1) DHCP Addr. Assignment must be checked      
     if(document.forms[0].vap_dhcp_required.checked==false){ 
        alert("DHCP Addr. Assignment must be checked when contivity is enabled.");
        return false;
     }
     // 2) IKE - authentication
     //       -Xauth preshared key only
    //         error when Certificate and Preshared key are used.
     if( (document.forms[0].vap_vpn_ike_auth[0].checked) ||
            (document.forms[0].vap_vpn_ike_auth[1].checked) ){
        alert("Only Xauth Pre Shared Key is allowed when contivity is enabled.");
       return false;
     }
     else
     {
       newKeySize = document.forms[0].XauthPsk_key.value.length;
       var currentIkeAuth=document.forms[0].current_ikeauth_type.value;
       var currentIkeAuthType=currentIkeAuth.indexOf("XAuth");
       if ( currentIkeAuthType>=0){
        // this means current is also XAUTH 
          if ( oldKeySize < 8 && newKeySize < 8){
            if( confirm("A XAuth Preshared Key length of less than 8 bytes will not interoperate with other vendor's VPN client. Are you sure you want to continue?") == false)
               return false;
          }
       }
       else{
           // current is not XAuth, user is going for new XAUTH key
          if ( newKeySize == 0 ){
            alert("For the chosen IKE Authentication mode for IPsec Security with contivity , XAuth Preshared Key is mandatory. Please specify it and then click Apply.");
            return false;
          }
          if ( newKeySize < 8){
            if( confirm("A XAuth Preshared Key length of less than 8 bytes will not interoperate with other vendor's VPN client. Are you sure you want to continue?") == false)
               return false;
          }
       }
     }
     // 3) IKE Phase 1 
     //    aggressive mode only .. error when main is selected
     var ikePhase1Index=document.forms[0].vap_vpn_ike_phase1.selectedIndex;
     if(document.forms[0].vap_vpn_ike_phase1.options[ikePhase1Index].value=="Main"){
        alert("Only 'aggressive' option can be chosen for IKE Phase1 when contivity is enabled.");
       return false;
     }

   }
 }

/*
 if(document.forms[0].sIPsec.options[document.forms[0].sIPsec.selectedIndex].value == "vpn_l2tp"){
    // if ipsec and selected Ike Auth is not Cert and admin status is enabled
    // then KeySize should be nonzero or propmt user to enter the key
    var keyNeeded = !(document.forms[0].l2tp_vap_vpn_ike_auth[0].checked);
    if(keyNeeded){
        var adminEnabled = document.forms[0].vap_admin_status.checked;
        var oldKeySize = document.forms[0].l2tp_ipsec_key_size.value;
        var newKeySize;
        if(document.forms[0].l2tp_vap_vpn_ike_auth[1].checked)
            newKeySize = document.forms[0].l2tp_preshared_key.value.length;
        if(oldKeySize == 0 && newKeySize == 0 && adminEnabled){
            alert("For the chosen IKE Authentication mode for IPsec Security, Preshared Key is mandatory. Please specify it and then click Apply.");
            return false;
        }
        if((newKeySize == 0 && oldKeySize < 8) || (newKeySize > 0 && newKeySize < 8)){
            if( confirm("A Preshared Key length of less than 8 bytes will not interoperate with other vendor's VPN client. Are you sure you want to continue?") == false)
                return false;
        }
    }
    if(document.forms[0].vap_dhcp_required.checked == false){
        alert("DHCP Address Assignment must be set to Required for L2TP Security");
        return false;
    }
 }
 */




if(document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_static" || document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_static_8021x") {
     var keyType = document.forms[0].key_size.value;
     var key = document.forms[0].wep_key.value;
     if(keyType == "not_set"){
        if(key.length != 0){
            alert("Please set the Static WEP key size, index, key string and format to complete the security configuration.");
            return false;
        }
     }


    if(document.forms[0].key_format[1].selected == true){
     if(keyType == "size_40"){
       if(key.length != 10){
         alert("For Static WEP key of size 40 bits, the key must be exactly 10 hex characters long whereas you entered "+key.length);
         return false;
       }
     }
     else if(keyType == "size_104"){
       if(key.length != 26){
         alert("For Static HEX WEP key of size 104 bits, the key must be exactly 26 hex characters long whereas you entered "+key.length);
         return false;
       }
     }
     else if(keyType == "size_128"){
       if(key.length != 32){
         alert("For Static HEX WEP key of size 128 bits, the key must be exactly 32 hex characters long whereas you entered "+key.length);
         return false;
       }
     }
     // now make sure all are hex characters
     for(var i=0;i < key.length;i++){
     	if(isNaN(parseInt(key.substring(i,i+1),16))){
     	  alert(key+" : "+"Static HEX WEP key is invalid. It needs to be all HEX characters. The value which is not HEX is"+" : " + key.substring(i,i+1));
     	  return false;
     	}
     }
   }else if(document.forms[0].key_format[0].selected == true){ /* ASCII KEY */

     if(keyType == "size_40"){
       if(key.length != 5){
         alert("For Static ASCII WEP key of size 40 bits, the key must be exactly 5 ASCII characters long whereas you entered "+key.length);
         return false;
       }
     }
     else if(keyType == "size_104"){
       if(key.length != 13){
         alert("For Static ASCII WEP key of size 104 bits, the key must be exactly 13 ASCII characters long whereas you entered "+key.length);
         return false;
       }
     }
     else if(keyType == "size_128"){
       if(key.length != 16){
         alert("For Static ASCII WEP key of size 128 bits, the key must be exactly 16 ASCII characters long whereas you entered "+key.length);
         return false;
       }
     }
   }
 }
 

 if(document.forms[0].local_auth.checked){
    if(document.forms[0].eap_profile.value == ''){
		alert("Please configure and select an eap profile for Local-EAP Auth");
		return false;
	}
		
 }



if ((selectedVal=="security_web") && (document.forms[0].passive_client.checked == true)) {
        alert("Cannot enable Passive client and layer3 simultaneously");
        return false;
}

     if((document.forms[0].vap_dhcp_required.checked==true) && (document.forms[0].passive_client.checked == true)) {
        alert("Cannot enable Passive client and DHCP required simultaneously");
        return false;
}



 // Check that (1) atleast one of WPA1/WPA2 policy is enabled when WPA has been selected for L2 Security policy
 //            (2) key length is valid if AKM-PSK has been choosen.
 var l2sec = document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value;
 //WPA should not be disabled when hotspot is enabled.
 var hotspot = document.forms[0].hotSpotStatus.value;
 if (l2sec == "wep_wpa1wpa2") {
     var wpa1sel = document.forms[0].wpa1_policy.checked;
     var wpa2sel = document.forms[0].wpa2_policy.checked;
     var wpa1aes = document.forms[0].wpa1_aes_encryption.checked;
     var wpa1tkip = document.forms[0].wpa1_tkip_encryption.checked;

     if ((wpa1sel == false)&&(wpa2sel == false)) {
            alert("At least one WPA policy must be enabled.");
            return false;
     }

/*     if (wpa1sel == true)
     {	   
	 if (wpa1tkip == true)
         {
             if ((wpa1aes == false) && (wpa2sel == false)) 
             {
                alert("TKIP as standalone cipher is not allowed for WLAN.");
                return false;
             }			     
	     else if((wpa1aes == true) && (wpa2sel == false))
             {
                alert("WPA1-AES/TKIP is only allowed by conjunction with WPA2-AES");
		return false;
             }		     
         }
     }	 */

     if (document.forms[0].PSK.checked == true || document.forms[0].FT_PSK.checked ==true || document.forms[0].w11Psk.checked == true) { 
         var keytype = document.forms[0].akm_psk_format.options[document.forms[0].akm_psk_format.selectedIndex].value;
         var key = document.forms[0].akm_psk_key.value;

	if( key != "*****" )
	{
         if ((keytype == "format_hex") && ((key.length % 2) != 0)) {
            alert("Please enter even number of hex characters to set the Pre-Shared Key in hex format.");
            return false;
         }
         if ((keytype == "format_hex") && (key.length != 64)) {
            alert("Pre-Shared Key in hex format should be exactly 64 hex chars.");
            return false;
         }
         if ( (keytype == "format_ascii") && 
              ((key.length < 8) || (key.length > 63)) ) {
            alert("Pre-Shared Key in ascii format should be in the range of 8 to 63 chars in length.");
            return false;
         }
	}
     }
     if((document.forms[0].ft.checked == true) && (document.forms[0].FT_DOT1X.checked == false) && (document.forms[0].FT_PSK.checked == false)) 
     {   
         alert(" At least one FT AKM must be enabled when Fast Transition is enabled.");
         return false;
     }

 }
 else if(hotspot != 0){
     alert("WPA cannot be disabled when Hotspot is enabled on the WLAN. Disable Hotspot 2.0 config before disabling the WPA security policy.");
     return false;
 }

 if (l2sec == "wep_ckip") {

	if ( !document.forms[0].ckip_mmhmode.checked && !document.forms[0].ckip_keyperm.checked )
	{
		alert("CKIP cannot be set with both MMH and Key Permutation disabled.");
		return false;
	}
	else //Check the key parameters over here
	{
     		var theKey = document.forms[0].ckip_wep_key.value ;

		if( theKey != "*****" ) {
     		var keySize = document.forms[0].ckip_key_size.options[document.forms[0].ckip_key_size.selectedIndex].value ;
     		var keyFormat = document.forms[0].ckip_key_format.options[document.forms[0].ckip_key_format.selectedIndex].value ;

		if( keyFormat == "ckip_format_hex" )
		{
			if( (theKey.length % 2)  != 0)
			{
				alert("Please enter even number of hex characters to set the Encryption Key in hex format.");
				return false;
			}
			else
			{
				if( ( keySize == "ckip_size_40" )  && (theKey.length != 10 ) )
				{
         				alert("For CKIP HEX key of size 40 bits, the key must be exactly 10 hex characters long whereas you entered "+theKey.length);
					return false;
				}
				else if (( keySize == "ckip_size_104" ) && (theKey.length != 26 ))
				{
         				alert("For CKIP HEX  key of size 104 bits, the key must be exactly 26 hex characters long whereas you entered "+theKey.length);
					return false;
				}
			}
		}
		else if( keyFormat == "ckip_format_ascii" )
		{
			if( ( keySize == "ckip_size_40" )  && (theKey.length != 5 ) )
			{
         			alert("For CKIP ASCII key of size 40 bits, the key must be exactly 5 ASCII characters long whereas you entered "+theKey.length);
				return false;
			}
			else if( ( keySize == "ckip_size_104" )  && (theKey.length != 13 ) )
			{
         			alert("For CKIP ASCII key of size 104 bits, the key must be exactly 13 ASCII characters long whereas you entered "+theKey.length);
				return false;
			}
		}
		}
	}

}

  //Do Only if wireless LANs end

 // Check that Rdaius authentication server entries are distinct.
 var auth1 = document.forms[0].auth_server_1.options[document.forms[0].auth_server_1.selectedIndex].value;
 var auth2 = document.forms[0].auth_server_2.options[document.forms[0].auth_server_2.selectedIndex].value;
 var auth3 = document.forms[0].auth_server_3.options[document.forms[0].auth_server_3.selectedIndex].value;
 var auth4 = document.forms[0].auth_server_4.options[document.forms[0].auth_server_4.selectedIndex].value;
 var auth5 = document.forms[0].auth_server_5.options[document.forms[0].auth_server_5.selectedIndex].value;
 var auth6 = document.forms[0].auth_server_6.options[document.forms[0].auth_server_6.selectedIndex].value;

 if( ( (auth1 != "none") && ((auth1 == auth2)||(auth1 == auth3)||(auth1 == auth4)||(auth1 == auth5)||(auth1 == auth6)) ) ||
     ( (auth2 != "none") && ((auth2 == auth3)||(auth2 == auth4)||(auth2 == auth5)||(auth2 == auth6)) ) ||
     ( (auth3 != "none") && ((auth3 == auth4)||(auth3 == auth5)||(auth3 == auth6)) ) ||
     ( (auth4 != "none") && ((auth4 == auth5)||(auth4 == auth6)) ) ||
     ( (auth5 != "none") && (auth5 == auth6) ) ) {
         alert("Cannot have duplication in Radius Authentication Server entries.");
         return false;
 }

 // Check that Rdaius accounting  server entries are distinct.
 var acc1 = document.forms[0].acc_server_1.options[document.forms[0].acc_server_1.selectedIndex].value;
 var acc2 = document.forms[0].acc_server_2.options[document.forms[0].acc_server_2.selectedIndex].value;
 var acc3 = document.forms[0].acc_server_3.options[document.forms[0].acc_server_3.selectedIndex].value;
 var acc4 = document.forms[0].acc_server_4.options[document.forms[0].acc_server_4.selectedIndex].value;
 var acc5 = document.forms[0].acc_server_5.options[document.forms[0].acc_server_5.selectedIndex].value;
 var acc6 = document.forms[0].acc_server_6.options[document.forms[0].acc_server_6.selectedIndex].value;

 if( ( (acc1 != "none") && ((acc1 == acc2)||(acc1 == acc3)||(acc1 == acc4)||(acc1 == acc5)||(acc1 == acc6)) ) ||
     ( (acc2 != "none") && ((acc2 == acc3)||(acc2 == acc4)||(acc2 == acc5)||(acc2 == acc6)) ) ||
     ( (acc3 != "none") && ((acc3 == acc4)||(acc3 == acc5)||(acc3 == acc6)) ) ||
     ( (acc4 != "none") && ((acc4 == acc5)||(acc4 == acc6)) ) ||
     ( (acc5 != "none") && (acc5 == acc6) ) ) {
         alert("Cannot have duplication in Radius Accounting Server entries.");
         return false;
 }
                                                                                                                                                             
 // Check that LDAP server entries are distinct.
 var ldap1 = document.forms[0].ldap_server_1.options[document.forms[0].ldap_server_1.selectedIndex].value;
 var ldap2 = document.forms[0].ldap_server_2.options[document.forms[0].ldap_server_2.selectedIndex].value;
 var ldap3 = document.forms[0].ldap_server_3.options[document.forms[0].ldap_server_3.selectedIndex].value;
 if( ( (ldap1 != "none") && ((ldap1 == ldap2)||(ldap1 == ldap3)) ) ||
     ( (ldap2 != "none") && (ldap2 == ldap3)                     ) ) {
         alert("Cannot have duplication in LDAP Server entries.");
         return false;
 }
 
 
  // IF_NOT_SMB


 var bandSelCheckBoxVal = document.forms[0].band_select;
 if (bandSelCheckBoxValOnLoad != bandSelCheckBoxVal.checked) {
     if (bandSelCheckBoxVal.checked == true) {
         if (!confirm("Warning: Allowing Band Select on this WLAN may impact time sensitive application like VOICE. Do you want to continue?")) {
             bandSelCheckBoxVal.checked = false;
             return false;
         }
     }
 }

 var loadBalCheckBoxVal = document.forms[0].load_bal;
 if (loadBalCheckBoxValOnLoad != loadBalCheckBoxVal.checked) {
     if (loadBalCheckBoxVal.checked == true) {
         if (!confirm("Warning: Allowing Load Balance Select on this WLAN may impact time sensitive application like VOICE. Do you want to continue?")) {
             loadBalCheckBoxVal.checked = false;
             return false;
         }
     }
 }

var universalAdminCheckBoxVal = document.forms[0].universal_admin;
 var universalAdminSecure = false;
 if ((document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_wpa1wpa2")|| (document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_8021x")) {
     universalAdminSecure = true;
 }
 if (universalAdminCheckBoxOnLoad != universalAdminCheckBoxVal.checked) {
     if (universalAdminCheckBoxVal.checked == true) {
         if (universalAdminSecure != true) {
             alert("Universal Admin Mode can be enabled only for 8021x/WPA/WPA2 secured WLANs for 8021x/WPA/WPA2 secured WLANs");
             universalAdminCheckBoxVal.checked = false;
             return false;
         }else{
             if (!confirm("Are you you want to enable Universal Admin Mode?")) {
                 universalAdminCheckBoxVal.checked = false;
                 return false;
             }
        }

      }
    }
    else 
    {
       if (universalAdminCheckBoxVal.checked == true) {
          if (document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_none") {
	      alert("Cannot disable security when Universal Admin is enabled!!");
	      return false;
	      }
          else if(universalAdminSecure !=true ) {
              if (!confirm("Universal admin mode not supported for the given security type  and proceeding with this security type will disable the universal admin mode. Press Ok to continue")) {
                  universalAdminCheckBoxVal.checked = true;
                  return false;
              }
              else {
                  universalAdminCheckBoxVal.checked = false;
              }
           }
        }
    }    


  if(

     (selectedVal=="security_web") &&
     (document.forms[0].security_web_options[0].checked || document.forms[0].security_web_options[1].checked
      || document.forms[0].security_web_options[4].checked) &&


           (document.forms[0].Over_ride_global_config.checked) &&

     (document.getElementById('webauthtypeid').value == 'External')) {
         
         if((document.forms[0].aclName.options[document.forms[0].aclName.selectedIndex].value == '') &&
           (document.forms[0].aclNamev6.options[document.forms[0].aclNamev6.selectedIndex].value == '') &&
           (document.forms[0].webauth_acl.options[document.forms[0].webauth_acl.selectedIndex].value == '')){
            if(!confirm("Please make sure preauth ACL is configured for external Web Authentication to work."))
               return false;
         }
         
         if((document.forms[0].url_textbox.value.length) < 1 ) {
               alert("Please provide the external webauth URL!");
               return false;
         }
         if((document.forms[0].url_textbox.value.length) > 254 ) {
               alert("Maximum allowed characters for external webauth URL is 254!");
               return false;
         }
     }
 



if((selectedVal=="security_web") && (document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "eap_passthru")) {

        alert("EAP-Passthrough is supported only on Open WLANs.Please disable L3 security.");
        return false;
}

 if((document.forms[0].reap_switching.checked) && (document.forms[0].nac.options[document.forms[0].nac.selectedIndex].value == "nac_state")) {
     if (!confirm("NAC is not supported with FlexConnect Local Switching. Do you want to continue?"))
         return false;
 }

   if (document.forms[0].nac.options[document.forms[0].nac.selectedIndex].value == "posture_state"){

       if(document.forms[0].vap_radius_override.checked == false) {
                alert("Please enable AAA override for Radius NAC");
                return false;
        }

       if(document.forms[0].reap_local_auth.checked == true) {
        alert("Disable FlexConnect local auth before enabling Radius NAC");
        return false;
    }


       if (document.forms[0].passive_client.checked == true) {
        alert("Cannot enable Passive client and Radius NAC simultaneously");
        return false;
      }


       //if web-auth is enabled with radius NAC
       if (selectedVal=="security_web") {
	 //check for Web-Auth
         if (document.forms[0].security_web_options[0].checked != true) {
           alert("Web-Auth is the only Layer3 security allowed with Radius NAC.");
           return false;
         }
	 //check for MAC filtering 
         if (document.forms[0].mac_filtering.checked == true){ 
           alert("Cannot enable MAC filtering and Web-Auth with Radius NAC.");
           return false;
         }
	 //check for 802.1x 
	 if((document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_8021x")){
           alert("Cannot enable 802.1x and Web-Auth with Radius NAC.");
           return false;
	 }
         if(document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "eap_passthru") {
           alert("Cannot enable EAP-Passthrough with Radius NAC.");
           return false;
         }


	 //check for WPA-PSK 
	 if((document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_wpa1wpa2") && (document.forms[0].PSK.checked == true )){
           alert("Radius NAC is available only for WLANs that are configured for 802.1X/WPA/WPA2 Layer 2 security Or Open Auth + MAC Filtering.");
           return false;
	 }
	 //If Web-Auth is enabled, check priority order
         if(document.forms[0].auth_prty2a[0]){ 
           if((document.forms[0].auth_prty2a[1]) || (document.forms[0].auth_prty2a[0].value != "2")){ 
             alert("Only RADIUS option can be configured in Web-Auth priority order with Radius NAC.");
             return false;
           }
	 }
	 else{ 
            alert("RADIUS option in Web-Auth priority order has to be configured with Radius NAC.");
            return false;
	 }

       }
       //Check for WEP and CKIP without web-auth
       else if((document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_ckip") || (document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_static")){
         alert("Static WEP and CKIP can be enabled only with Web-Auth when Radius NAC is enabled.");
         return false;
       }
       //check for WPA-PSK without web-auth 
       else if((document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_wpa1wpa2") && (document.forms[0].PSK.checked == true || document.forms[0].FT_PSK.checked == true)){
           alert("Radius NAC is available only for WLANs that are configured for 802.1X/WPA/WPA2 Layer 2 security Or Open Auth + MAC Filtering.");
           return false;
       }

       if(document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_static_8021x"){
	 alert("Static WEP+802.1x cannot be enabled with Radius NAC.");
         return false;
       }
 
       if ((document.forms[0].mac_filtering.checked == true) && (document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value != "wep_none")) {
          alert("Cannot enable MAC filtering and other Layer2 Security with Radius NAC.");
          return false;
       }


       if ((document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value == "wep_none") && (document.forms[0].mac_filtering.checked == false) && (selectedVal != "security_web")) {
          alert(" Request Failed -  The Security configuration is not compatible with Radius NAC.");
          return false;
       }



 }



  



 if(document.forms[0].vlan_central_switching.checked == true){
     if(document.forms[0].reap_local_auth.checked == true){
 	 alert("VLAN based central switching and FlexConnect Local Auth cannot be enabled together.");
 	 return false;
     }
     if(document.forms[0].vap_radius_override.checked == false) {
 	 alert("AAA Override is mandatory for VLAN based central switching.");
 	 return false;
     }
     if (selectedVal=="security_web"){
 	 alert("VLAN based central switching and web-auth cannot be enabled together.");
 	 return false;
     }
 }




 
    if((document.forms[0].reap_local_auth.checked == true) && 
     ((document.forms[0].dhcp_profiling.checked == true) || 
      (document.forms[0].http_profiling.checked == true) ||
      (document.forms[0].local_dhcp_profiling.checked == true) || 
      (document.forms[0].local_http_profiling.checked == true))){
	 alert("Client Profiling cannot be enabled with FlexConnect Local Auth");
         return false;
   }

   if((document.forms[0].central_dhcp.checked == false) && (document.forms[0].nat_pat.checked == true)){
   	alert("NAT-PAT cannot be enabled without Central DHCP");
        return false;
   }

   if((document.forms[0].central_dhcp.checked == true) && (document.forms[0].vap_dhcp_required.checked != true)){
   	alert("FlexConnect Central DHCP cannot be enabled without setting DHCP Address Assignment to required");
        return false;
   }

   if((document.forms[0].bonjour_profiling.checked)&&(document.forms[0].reap_switching.checked)){
          var ok = confirm("Enabling FlexConnect Local Switching will disable mDNS Snooping.Press OK to continue.");
          if(!ok){
              return false;
            }
          else{
              document.forms[0].bonjour_profiling.checked = false;
              return true;
            }
   }
 



    var pmffield;
    pmffield = document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value;
    if(pmffield == "OPTIONAL" || pmffield ==  "REQUIRED")
      {
        if(document.forms[0].wpa2_policy.checked == false)
          {
           alert("WPA2 policy is Mandatory to make Protected Management Frame(PMF) Optional/Required.");
           return false;
          }
      }



 


   if((document.forms[0].sIPsec.options[document.forms[0].sIPsec.selectedIndex].value == "security_web")&&
                         (configured_vap_web_auth != document.forms[0].security_web_options[0].checked)){
      if((document.forms[0].security_web_options[0].checked ==true) && (document.forms[0].tunnel_profile.options[document.forms[0].tunnel_profile.selectedIndex].value != "None")){
          alert("Error! Tunnel Profile Attached to this WLAN. Web Auth security not supported");
          return false;
      }
   }
   if(configured_vap_local_auth != document.forms[0].reap_local_auth.checked){
      if((document.forms[0].reap_local_auth.checked == true) && (document.forms[0].tunnel_profile.options[document.forms[0].tunnel_profile.selectedIndex].value != "None")){
          alert("Error! Tunnel Profile Attached to this WLAN. Flexconnect Local Auth not supported");
          return false;
      }
   }
   if(configured_tunnel_profile != document.forms[0].tunnel_profile.options[document.forms[0].tunnel_profile.selectedIndex].value){
      if((document.forms[0].tunnel_profile.options[document.forms[0].tunnel_profile.selectedIndex].value != "None")&&
           (((document.forms[0].sIPsec.options[document.forms[0].sIPsec.selectedIndex].value == "security_web") &&(document.forms[0].security_web_options[0].checked ==true))||
           (document.forms[0].reap_local_auth.checked == true))){
          alert("Error! security Web Auth/Flex Local Auth enabled in this WLAN. Cannot attach Tunnel Profile");
          return false;
      }
   }


 if(oldAdminStatus && document.forms[0].vap_admin_status.checked){
    var ok = confirm("Changing WLAN parameters while it is enabled will cause the WLAN to be momentarily disabled and thus may result in loss of connectivity for some clients. Press OK to continue.");
    if(!ok) return false;
 }
 
 
 
  if(configured_vap_ssid != document.forms[0].vap_ssid.value)
  {
      if(document.forms[0].PSK.checked == true || document.forms[0].FT_PSK.checked == true || document.forms[0].w11Psk.checked == true)
      {
         if(document.forms[0].akm_psk_key.value== "*****"){
	      alert("Please enter the PSK key for modified SSID");  	 
              return false;
	 }	 
      }	      

  }

 
 
 
  if((document.forms[0].assisted_roaming.checked == true) && (document.forms[0].assisted_roamval.value != true)) {
         if (!confirm(" WARNING: Enabling neighbor list prediction optimization may slow association and impact VOICE client perform.")) {
             document.forms[0].assisted_roaming.checked = false;
             return false;
         }
 }

 if((document.forms[0].neigh_dualband.checked == true)&& (document.forms[0].neighbor_listval.value != true)) {
         if (!confirm(" WARNING: Sending dual band 802.11k neighbor list may cause problem to single band 802.11k client.")) {
             document.forms[0].neigh_dualband.checked = false;
             return false;
         }
 }
 
  
  return true;
}

function getPrtyOrder(obj){
        var prtyOrder = "";
        for (i=0; i<obj.options.length; i++) {
                prtyOrder += obj.options[i].value;
        }
        if(document.forms[0].mgmt_prtyOrder2){ 
                document.forms[0].mgmt_prtyOrder2.value = prtyOrder;
        } 
}

//to warn user that this wlan will not be pushed to cisco Aps
// if wep size is 128 bits.
function wepKeySizeSelection(){
	var keyType = document.forms[0].key_size.value;
	if(keyType == "size_128"){
		alert("WEP key size of 128 bits is not supported on 11xx, 12xx and 13xx model APs. Wlan will not be pushed to these Access Points.");
		document.getElementById('warnWep128').style.display = 'inline';
	}else
		document.getElementById('warnWep128').style.display = 'none';
}

//to warn user that this wlan will not be pushed to cisco Aps
// if wep size is 128 bits.
function wepKeySize8021xSelection(){
	var keyType = document.forms[0].key_size_8021x.value;
	if(keyType == "size_128"){
		alert("WEP key size of 128 bits is not supported on 11xx, 12xx and 13xx model APs. Wlan will not be pushed to these Access Points.");
		document.getElementById('warnX8021Wep128').style.display = 'inline';
	}else
		document.getElementById('warnX8021Wep128').style.display = 'none';
}

function displayProfile(){
if(document.forms[0].local_auth.checked)
	document.getElementById('profile_div').style.display = 'inline';
else
	document.getElementById('profile_div').style.display = 'none';
}
function displayBonjour(){
 
      if(document.forms[0].bonjour_profiling.checked)
           document.getElementById('bonjour_div').style.display = 'inline';
      else
           document.getElementById('bonjour_div').style.display = 'none';
 
}

function flexCheck(){
 
 if(document.forms[0].reap_switching.checked == false)
    {
      if(document.forms[0].bonjour_profiling.checked)
           document.getElementById('bonjour_div').style.display = 'inline';
      else
           document.getElementById('bonjour_div').style.display = 'none';
    }
 else
    {
     if(document.forms[0].bonjour_profiling.checked)
      {
        alert("mDNS Snooping is not supported with Flex Connect Local Switching");
        document.forms[0].bonjour_profiling.checked = false;
        document.getElementById('bonjour_div').style.display = 'none';
      }    
    }
 
}

function setAccountingState(){

   if(!document.forms[0].acc_enable.checked)
   {
		document.forms[0].acc_server_1.disabled = true;
		document.forms[0].acc_server_2.disabled = true;
		document.forms[0].acc_server_3.disabled = true;
		document.forms[0].acc_server_4.disabled = true;
		document.forms[0].acc_server_5.disabled = true;
		document.forms[0].acc_server_6.disabled = true;
                document.forms[0].interim_update.checked = false; 
                document.forms[0].interim_update.disabled = true;
                document.getElementById('interim_interval_div').style.display = 'none';
   }else{
		document.forms[0].acc_server_1.disabled = false;
		document.forms[0].acc_server_2.disabled = false;
		document.forms[0].acc_server_3.disabled = false;
		document.forms[0].acc_server_4.disabled = false;
		document.forms[0].acc_server_5.disabled = false;
		document.forms[0].acc_server_6.disabled = false;
                document.forms[0].interim_update.disabled = false;
   }

}
function setAuthenticatingState(){
   if(!document.forms[0].auth_enable.checked)
   {
      document.forms[0].auth_server_1.disabled = true;
      document.forms[0].auth_server_2.disabled = true;
      document.forms[0].auth_server_3.disabled = true;
      document.forms[0].auth_server_4.disabled = true;
      document.forms[0].auth_server_5.disabled = true;
      document.forms[0].auth_server_6.disabled = true;
   }else{
      document.forms[0].auth_server_1.disabled = false;
      document.forms[0].auth_server_2.disabled = false;
      document.forms[0].auth_server_3.disabled = false;
      document.forms[0].auth_server_4.disabled = false;
      document.forms[0].auth_server_5.disabled = false;
      document.forms[0].auth_server_6.disabled = false;
   }
}
function changeCkipKeyDisplay(){
	if(document.getElementById('ckip_key_size').value == 'ckip_not_set')
	{
		document.forms[0].ckip_key_index.disabled = true;
		document.forms[0].ckip_wep_key.disabled = true;
		document.forms[0].ckip_key_format.disabled = true;
		document.forms[0].ckip_wep_key.value = "";
	}else{
		document.forms[0].ckip_key_index.disabled = false;
		document.forms[0].ckip_wep_key.disabled = false;
		document.forms[0].ckip_key_format.disabled = false;
	}
}
function changeWepKeyDisplay(){
	if(document.getElementById('key_size').value == 'not_set')
	{
		document.forms[0].WepKeyIndex.disabled = true;
		document.forms[0].wep_key.disabled = true;
		document.forms[0].key_format.disabled = true;
		document.forms[0].wep_key.value = "";
	}else{
		document.forms[0].WepKeyIndex.disabled = false;
		document.forms[0].wep_key.disabled = false;
		document.forms[0].key_format.disabled = true;
		wepKeySizeSelection();
	}
}

function macDot1xEnable() {
       if(document.forms[0].mac_filtering.checked){
           document.forms[0].mac_dot1x.disabled = false;
       }
       else{
           document.forms[0].mac_dot1x.disabled = true;
           document.forms[0].mac_dot1x.checked = false;
       }
}
//Ignore Client ip is configurable only when the HREAP Local switching is enabled.
function enableLocalSwitchingParameters()
{ 
 
   if(document.forms[0].reap_switching.checked){
       document.forms[0].ignore_clientip.disabled = true;
    /* Hiding HREAP local auth feature */
       document.forms[0].reap_local_auth.disabled = false;
       document.forms[0].central_dhcp.disabled = true;
       document.forms[0].dns.disabled = true;
       if(document.forms[0].central_dhcp.checked){
       	   document.forms[0].nat_pat.disabled = false;
       }
       else{
       	   document.forms[0].nat_pat.disabled = true;
       	   document.forms[0].nat_pat.checked = false;
       }

       document.forms[0].vlan_central_switching.disabled = true;
//       document.forms[0].hreapavcprofile.disabled = false;
   } else {
        document.forms[0].ignore_clientip.disabled = true;
    /* Hiding HREAP local auth feature */
        document.forms[0].reap_local_auth.disabled = true;
        document.forms[0].reap_local_auth.checked = false;
        document.forms[0].central_dhcp.disabled = true;
        document.forms[0].central_dhcp.checked = false;
        document.forms[0].dns.disabled = true;
        document.forms[0].dns.checked = false;
       	document.forms[0].nat_pat.disabled = true;
       	document.forms[0].nat_pat.checked = false;



        document.forms[0].vlan_central_switching.checked = false;
        document.forms[0].vlan_central_switching.disabled = true;
        if(document.forms[0].max_clients.disabled == true)
            document.forms[0].max_clients.disabled = false;
//       document.forms[0].hreapavcprofile.disabled = true;
   }

 
}


//gray out Mac filtering and max clients when the HREAP Local Auth is enabled.
function enableLocalAuthParameters()
{ 
   /* Hiding mac filtering and max client allowed feature */
   if(document.forms[0].reap_local_auth.checked){
       document.forms[0].mac_filtering.checked = false;
       document.forms[0].mac_filtering.disabled = true;
       document.forms[0].max_clients.value = 0;
       document.forms[0].max_clients.disabled = true;
       document.forms[0].central_assoc.disabled = true;
       document.forms[0].central_assoc.checked = false;
   } else {
       document.forms[0].mac_filtering.disabled = false;
       document.forms[0].max_clients.disabled = false;
       document.forms[0].central_assoc.disabled = true;
   } 

}

//gray out NAT-PAT when the HREAP Central switching is disabled.
function enableNatPat()
{ 
       if(document.forms[0].central_dhcp.checked){
       	   document.forms[0].nat_pat.disabled = false;
       	   document.forms[0].nat_pat.checked = true;
       }
       else{
       	   document.forms[0].nat_pat.disabled = true;
       	   document.forms[0].nat_pat.checked = false;
       }
}

function nacHreapAndAaa()
{
   /* Hiding hreap local switching and enabling AAA override */
   if (document.forms[0].nac.options[document.forms[0].nac.selectedIndex].value == "posture_state"){

     if (document.forms[0].reap_local_auth.checked != true) {
       document.forms[0].reap_local_auth.disabled = true; 
     }
       document.forms[0].vap_radius_override.checked = true;
   }
   else if (document.forms[0].reap_switching.checked == true) {
       document.forms[0].reap_local_auth.disabled = false; 
   }
}


function diagChannelConfigAlert()
{
 var diag = document.forms[0].diag_cha.checked;
 diagChannelChecked();
 if (!confirm("Changing the diagnostic channel setting may cause changes to the present WLAN configuration.Are you sure want to continue?"))
    document.forms[0].diag_cha.checked = !(diag);
}
function hideSnooping()
{

   if( document.forms[0].diag_cha.checked == true )
   {
      document.forms[0].voip_call_failure.disabled = true;
   }
   else
   {
      document.forms[0].voip_call_failure.disabled = true;
   }

}

function show128Warn()
{
   if(document.forms[0].note_128_earlier.value == 1)
   {
     document.getElementById("note_earlier_128").style.display = 'inline'; 
   }
}

function prioFunc()
{

   var count_prio_disable = 0;
   if(document.forms[0].prio_0.checked == true)
   {
      count_prio_disable++;
   }
   if(document.forms[0].prio_1.checked == true)
   {
      count_prio_disable++;
   }
   if(document.forms[0].prio_2.checked == true)
   {
      count_prio_disable++;
   }
   if(document.forms[0].prio_3.checked == true)
   {
      count_prio_disable++;
   }
   if(document.forms[0].prio_4.checked == true)
   {
      count_prio_disable++;
   }
   if(document.forms[0].prio_5.checked == true)
   {
      count_prio_disable++;
   }
   if(document.forms[0].prio_6.checked == true)
   {
      count_prio_disable++;
   }
   if(document.forms[0].prio_7.checked == true)
   {
      count_prio_disable++;
   }

   if(!count_prio_disable)
   {
      document.forms[0].scan_defer_time.disabled = true;
      document.forms[0].no_prio_sel.value = 0;
   }
   else
   {
      document.forms[0].scan_defer_time.disabled = true;
      document.forms[0].no_prio_sel.value = 1;
   }

   return true;
}


function setProfilingDep()
{
   if((document.forms[0].dhcp_profiling.checked == true)&&
      ((document.forms[0].vap_dhcp_required.checked != true)||
      (document.forms[0].reap_local_auth.checked != false)))
   {
      if( confirm("Enabling Client Profiling requires disabling Local Auth. Calling-Station-Id will be Mac address for Accounting messages. Press OK to continue.") == true){
          document.forms[0].reap_local_auth.checked = false;
      }
   }
}





function setLocalProfilingDep()
{
   if((document.forms[0].local_dhcp_profiling.checked == true)&&
      ((document.forms[0].vap_dhcp_required.checked != true)||
      (document.forms[0].reap_local_auth.checked != false)))
   {
      if( confirm("Enabling Client Profiling requires disabling Local Auth. Calling-Station-Id will be Mac address for Accounting messages. Press OK to continue.") == true){
          document.forms[0].reap_local_auth.checked = false;
      }
   }
}

function showHttpTimeOut() 
{
  if((document.forms[0].http_profiling.checked == true) && (document.forms[0].reap_local_auth.checked == true))
  {
      alert("Client Profiling cannot be enabled with FlexConnect Local Auth"); 
      return false;
  }
}

function resetUserLimits()
{
      if( confirm("All the per-user Override rate limits will be reset to zero and the values defined in the selected QoS profile will take effect. Click OK to continue.") == true){
          document.forms[0].data_average.value = 0;
          document.forms[0].data_average_us.value = 0;
          document.forms[0].data_burst.value = 0;
          document.forms[0].data_burst_us.value = 0;
          document.forms[0].real_time_average.value = 0;
          document.forms[0].real_time_average_us.value = 0;
          document.forms[0].real_time_burst.value = 0;
          document.forms[0].real_time_burst_us.value = 0;
      }
}

function resetSsidLimits()
{
      if( confirm("All the per-ssid Override rate limits will be reset to zero and the values defined in the selected QoS profile will take effect. Click OK to continue.") == true){
          document.forms[0].wlan_data_average_ds.value = 0;
          document.forms[0].wlan_data_average_us.value = 0;
          document.forms[0].wlan_data_burst_ds.value = 0;
          document.forms[0].wlan_data_burst_us.value = 0;
          document.forms[0].wlan_real_time_average_ds.value = 0;
          document.forms[0].wlan_real_time_average_us.value = 0;
          document.forms[0].wlan_real_time_burst_ds.value = 0;
          document.forms[0].wlan_real_time_burst_us.value = 0;
      }
}

function addPolicyToWlan(){
     if(document.forms[0].policy_new.value == "")
     {
            alert("Policy cannot be NULL.");
            return false;
     }
     if((document.forms[0].pri_new.value == "") || (document.forms[0].pri_new.value < 1) || (document.forms[0].pri_new.value > 16))
     {
            alert("Please enter a Priority Index Between 1 and 16.");
            return false;
     }

     var totalEntries = 0;
     for(var loop=0; loop < document.forms[0].elements.length;loop++){
       if(document.forms[0].elements[loop].name && (document.forms[0].elements[loop].name.indexOf("policy_name") > -1))
       {
         //check for duplicate wlanIndex
         if( (""+document.forms[0].elements[loop].value) == document.forms[0].policy_new.value)
         {
            alert("Policy already exists on the WLAN.");
            return false;
         }
         totalEntries++;
       }
       if(document.forms[0].elements[loop].name && (document.forms[0].elements[loop].name.indexOf("pri_index") > -1))
       {
         //check for duplicate wlanIndex
         if( (""+document.forms[0].elements[loop].value) == document.forms[0].pri_new.value)
         {
            alert("Priority Index is already in use.");
            return false;
         }
       }
     }
     //check for maximum numbers reached.
     if(totalEntries >= 16) {
        alert("Cannot add more than 16 Policies to the WLAN");
        return false;
     }
     if(document.forms[0].vap_admin_status.checked){
         var ok = confirm("Changing WLAN parameters while it is enabled will cause the WLAN to be momentarily disabled and thus may result in loss of connectivity for some clients. Press OK to continue.");
         if(!ok) return false;
     }

    document.forms[0].buttonClicked.value = CREATE_CLICKED;
    document.forms[0].submit();
}

function deletePolicyFromWlan(index) {
     debugMsg("<deleteAction> index is "+index);
	if(confirm(top.ARE_YOU_SURE_DELETE)){
                if(document.forms[0].vap_admin_status.checked){
                    var ok = confirm("Changing WLAN parameters while it is enabled will cause the WLAN to be momentarily disabled and thus may result in loss of connectivity for some clients. Press OK to continue.");
                    if(!ok) return false;
                }
		document.forms[0].indexClicked.value = index;
		document.forms[0].buttonClicked.value = DELETE_CLICKED;
		document.forms[0].submit();
	}
}

function setRadiusIntPriority() 
{
  if(document.forms[0].overwrite_int.checked == true)
       document.getElementById('intPriDiv').style.display = 'inline';
  else
       document.getElementById('intPriDiv').style.display = 'none';
}

function Pmfreqenable()
{
    var pmfsec = document.forms[0].w11pfm.options[document.forms[0].w11pfm.selectedIndex].value;
    if (pmfsec == "REQUIRED" || pmfsec =="OPTIONAL"){
         document.getElementById("w11PFM_Dropdown").style.display="block";
         document.getElementById("w11akmtime").style.display="block";
        }
    else if (pmfsec == "DISABLE"){
         document.getElementById("w11PFM_Dropdown").style.display="block";
       }
}




function showEapParams()
{
  if(document.forms[0].eap_enable.checked == true)
       document.getElementById('eap_parms').style.display = 'inline';
  else
       document.getElementById('eap_parms').style.display = 'none';
}

function allowEapParams()
{
  var l2Security = document.forms[0].sWep.options[document.forms[0].sWep.selectedIndex].value;
  if((l2Security == "wep_wpa1wpa2") || (l2Security == "wep_8021x")){
       document.getElementById('eap_parameters').style.display = 'inline';
     }
  else{
       document.forms[0].eap_enable.checked = false;
       document.getElementById('eap_parameters').style.display = 'none';
       document.getElementById('eap_parms').style.display = 'none';
     }
  return true;
}


function hidePolicyTab()
{
//     dojo.widget.byId("mainTabContainer").removeChild(dojo.widget.byId("tab6"));
}

function showLearnIPDep()
{
    if(!document.forms[0].ignore_clientip.checked)
        alert("Warning: Disabling Client Learn IP Address may cause breakage of IP based applications like mobility");
}

function checkLearnIPAgainstL2Acl()
{

    if(document.forms[0].ignore_clientip.checked)
    {	    
	    if(document.forms[0].l2acl.value != "")
		    alert("Warning: Learn Client IP Address should be disabled if L2Acl rule is used for denying the ARP/IP packets");
    }	    

  return true;
}

function dot1xFlagSet()
{

       if( document.forms[0].DOT1X.checked == true || document.forms[0].CCKM.checked == true ||document.forms[0].FT_DOT1X.checked == true ){
              document.forms[0].dot1xflag.value = 1;
        }
        else
        {
              document.forms[0].dot1xflag.value = 0
        }		
		
}

function dot1xDefaultSessionTimeout()
{


     if ( document.forms[0].DOT1X.checked == true || document.forms[0].CCKM.checked == true || document.forms[0].FT_DOT1X.checked == true ) {
	     if( document.forms[0].dot1xflag.value == 0)
             {		     
		    document.forms[0].vap_session_timeout_chkbx.checked = true;
                    showVapSessionTimeOut(true);
              }
    }	     

}

function diagChannelChecked()
{
 var diag = document.forms[0].diag_cha.checked;
 if(diag == true) {
      document.forms[0].P2PBlockingMode.value= "Drop";
      document.forms[0].P2PBlockingMode.disabled = true;
 } 
 else
 {
      document.forms[0].P2PBlockingMode.disabled = true;
 }	 

}

</script>


<FORM method="post" ACTION="frameWlanEdit.html">
<INPUT TYPE="hidden" NAME="access_control" SIZE="16" MAXLENGTH="15" VALUE="1">

<table CELLSPACING=0  WIDTH="100%" cellpadding="0" border="0">
    <tr>
      <td nowrap class="pageTitle">
        <h1 id = "headerprof">WLANs &gt; Edit </h1>
      </td>
      <td nowrap class="pageTitle" align="right">
        <input type="button" name="back" value="&lt; BACK" class="button" onclick="javascript:window.location='frameWlan.html';">
        &nbsp;&nbsp;&nbsp;
        <script> document.writeln('\
	<input type="button" name="apply" value="',top.APPLY,'" class="button" onClick="javascript:submitTheDataForm()">\
	');</script>
        
      </td>
    </tr>
  </table>


<div id="mainTabContainer" class="dojoTabContainer dojoLayoutContainer" wairole="tabpanel" role="wairole:tabpanel" style="width: 98%; height: 450px;">
	<div dojoattachpoint="dojoTabLabels" class="dojoTabLabels-top dojoAlignTop" style="left: 0px; top: 0px; bottom: auto; right: auto; width: 100%;">
		<div role="wairole:tab" class="dojoTabPaneTab current" id="tabLabel1" onclick="clickTab(lastTab, 'tab', '1');"><span>General</span></div>
		<div role="wairole:tab" class="dojoTabPaneTab" id="tabLabel2" onclick="clickTab(lastTab, 'tab', '2');"><span>Security</span></div>
		<div role="wairole:tab" class="dojoTabPaneTab" id="tabLabel4" onclick="clickTab(lastTab, 'tab', '4');"><span>QoS</span></div>
		<div role="wairole:tab" class="dojoTabPaneTab" id="tabLabel6" onclick="clickTab(lastTab, 'tab', '6');"><span>Policy-Mapping</span></div>
		<div role="wairole:tab" class="dojoTabPaneTab" id="tabLabel5" onclick="clickTab(lastTab, 'tab', '5');"><span>Advanced</span></div>
	</div>
	<div class="dojoTabPaneWrapper dojoAlignClient" dojoattachpoint="containerNode" style="left: 0px; top: 22px; bottom: auto; right: auto; width: 100%; height: 425px;">
	<!-- Start 'General' tab code -->
    <div id="tab1" dojotype="ContentPane" label="General" style="top: 0px; left: 0px; width: 100%; height: 425px; display: block; overflow: auto" class="dojoTabPane">
        <div class="tabcontent">
    <table cellspacing="0" cellpadding="0" border="0">
	  <tbody><tr>
      <td width="135" class="propertyLabel2">Profile Name</td>
      <td>
        <input type="TEXT" name="vap_profileName" size="42" maxlength="32" value="<?=WLAN-NAME=?>">
      </td>
    </tr>
      <tr>
      <td width="135" class="propertyLabel2">Type</td>
      <td>
        <input type="TEXT" name="lan_type" class="statictextboxDojo" readonly="" size="20" maxlength="20" value="WLAN">
      </td>
    </tr>

      <tr>
      <td class="propertyLabel2">SSID
      </td><td>
		  <input type="TEXT" name="vap_ssid" size="42" maxlength="32" value="<?=WLAN-SSID=?>">
      </td>
    </tr>
    <tr>
       <td class="propertyLabel2">Status</td>
          <!-- Unit -->
          <td>
            <table border="0" cellspacing="0" cellpadding="0">
              <tbody><tr>
                <td>
                  <input type="checkbox" name="vap_admin_status" value="enable" <?=WLAN-ENABLED=?>>&nbsp;
                  Enabled
                </td>
              </tr>
            </tbody></table>
          </td>
        </tr>
      <tr>
        <td colspan="2">&nbsp;</td>
      </tr>        
      
      <tr>
        <td colspan="2">&nbsp;</td>
      </tr>              
        <tr>
          <td class="propertyLabel2">Security Policies</td>          
          <td>
              <input type="TEXT" name="vap_security_types" class="statictextboxDojo" style="FONT-WEIGHT: bold;" readonly="" size="80" maxlength="80" value="<?=WLAN-AUTHEN=?>">
          </td>
        </tr>    
        <tr>
            <td>&nbsp;</td>
            <td>(Modifications done under security tab will appear after applying the changes.)</td>
        
      </tr><tr>
        <td colspan="2">&nbsp;</td>
      </tr>
      <tr>
        <td colspan="2">&nbsp;</td>
      </tr>      
        
       <!--IF_REMOTE_LAN-->
        
          <tr class="notSupported">
            <td class="propertyLabel2">Radio Policy</td>
            <!-- Unit -->
            <td>
              <select name="vap_radiopolicy" disabled>
                <option value="All" selected="">All</option>
                <option value="a_only">802.11a only</option>
				<option value="ag_only">802.11a/g only</option>
				
                <option value="g_only">802.11g only</option>
                <option value="bg_only">802.11b/g only</option>
              </select>
            </td>
          </tr>
        
	
        
            <tr>
         
              <td class="propertyLabel2">Interface/Interface Group(G) </td>
        
              <!-- Unit -->
              <td>
                <select name="interfaceName">
<!-- <option value="management" selected="">management
</option>
 -->
</select>
              </td>
            </tr>

            
              <tr class="notSupported">
                <td class="propertyLabel2">Multicast Vlan Feature</td>
                <td>
                    <input type="checkbox" name="multicast_vlan" onclick="showMulticastInterface()" value="enable" disabled>&nbsp;Enabled
                </td>
              </tr>

            <tr id="multicastIntf" style="display: none;">
              <td class="propertyLabel2">Multicast Interface</td>
              <td>
                <select name="multicast_interface">
<option value="management">management
</option><option value="vlan  twenty">vlan  twenty
</option><option value="vlan 10">vlan 10</option></select>
              </td>
            </tr>
          
            
            
              <!-- wlan broadcast flag -->
              <tr class="notSupported">
                <td class="propertyLabel2">Broadcast SSID</td>
                <td>
                  <table border="0" cellspacing="0" cellpadding="0">
                    <tbody><tr>
                      <td class="notSupported">
                        <input type="checkbox" name="vap_broadcast_ssid" value="enable" checked="" disabled>&nbsp;Enabled
                      </td>
                    </tr>
                  </tbody></table>
                </td>
              </tr>
            

              <!-- NAS-ID -->
              <tr class="notSupported"><td class="propertyLabel2">NAS-ID</td>
              <td>
                  <input type="TEXT" name="nasid" id="nasid" size="32" maxlength="31" value="" disabled>
              </td>
            
          </tr></tbody></table>
        </div> 
    </div>
	<!------- end 'General' Tab code ------>

	<!------- Start 'Security' Tab -------->
	<div id="tab2" dojotype="ContentPane" label="Security" style="top: 0px; left: 0px; width: 100%; height: 425px; display: none; overflow: auto" class="dojoTabPane">            
      <div id="secTabContainer" class="dojoTabContainer dojoLayoutContainer" wairole="tabpanel" role="wairole:tabpanel" style="width: 95%; height: 400px; padding-top: 10px; padding-left: 10px;">
	<div dojoattachpoint="dojoTabLabels" class="dojoTabLabels-top dojoAlignTop" style="left: 10px; top: 10px; bottom: auto; right: auto; width: 100%;">
		<div role="wairole:tab" class="dojoTabPaneTab current" id="sectabLabel1" onclick="clickTab(lastSecTab, 'sectab', '1');"><span>Layer 2</span></div>
		<div role="wairole:tab" class="dojoTabPaneTab" id="sectabLabel2" onclick="clickTab(lastSecTab, 'sectab', '2');"><span>Layer 3</span></div>
		<div role="wairole:tab" class="dojoTabPaneTab" id="sectabLabel3" onclick="clickTab(lastSecTab, 'sectab', '3');"><span>AAA Servers</span></div>
	</div>
	<div class="dojoTabPaneWrapper dojoAlignClient" dojoattachpoint="containerNode" style="left: 0px; top: 22px; bottom: auto; right: auto; width: 100%; height: 375px; overflow: auto">
	  <!------- Start 'Layer 2' tab inside 'Security' tab --------->
	  <div id="sectab1" dojotype="ContentPane" label="Layer 2" style="top: 0px; left: 0px; width: 100%; height: 375px;" class="dojoTabPane">
	  <div class="tabcontent">
	   
	   
            <table cellspacing="0" cellpadding="0" border="0">
            <tbody><tr>
              <td class="propertyLabel2">Layer 2 Security 
	      
		<sup title="See foot note below" onclick="alert('See foot note below');">6</sup>
	   <!--IF_WLAN_IS_WIRELESS-->
	      </td>
              <td>
              <select name="sWep" onchange="checkDropDown();showVapSessionTimeOut(true);allowEapParams();">
                <option value="wep_none">None</option>
	      
                <option value="wep_wpa1wpa2" selected="">WPA+WPA2</option>
	   <!--IF_WLAN_IS_WIRELESS-->
                <option value="wep_8021x">802.1X</option>
	      
                <option value="wep_static">Static WEP</option>

                <option value="wep_static_8021x">Static-WEP + 802.1X</option>

                <option value="wep_ckip">CKIP</option>

                <option value="eap_passthru">None + EAP Passthrough</option>
	   <!--IF_WLAN_IS_WIRELESS-->
              </select>
           <div id="eap_msg" style="display:none">
             <input type="text" class="statictextboxlist" name="eap_info" readonly="" size="100" value="(Warning: If EAP-Passthrough on the WLAN is enabled,it may be exposed to security attacks on the network.)"> 
           </div>


            </td>
          </tr>

	  <tr>
              <td class="propertyLabel2">&nbsp;</td>
              <td>
                <table border="0" cellspacing="0" cellpadding="0">
                <tbody><tr>
                    <td nowrap="">MAC Filtering</td> 
                    <td>

                <sup title="See foot note below" onclick="alert('See foot note below');">9</sup>
 <!--IF_WLAN_IS_WIRELESS -->
                      <input type="checkbox" name="mac_filtering" onclick="macDot1xEnable()"> </td>
                  </tr>
                </tbody></table>
              </td>
          </tr>
           </tbody></table>


            <div id="mac_box" style="display:none">
           
               &nbsp;
               
                 <table border="0" cellspacing="0" cellpadding="0">
                 <tbody><tr>
                    <td nowrap="">Mac Auth or Dot1x</td>
                     <td>
                        <input type="checkbox" name="mac_dot1x" disabled=""> </td>
                   </tr>
                 </tbody></table>
               
           
          </div>



          <div id="ft_box" style="display: block;">
            <table cellpadding="0" cellspacing="0" border="0">
            <tbody class="notSupported"><tr>
              <td class="propertyLabel" colspan="3">Fast Transition</td>
            </tr>
            <tr>
              <td colspan="1" class="lineProp"><img alt="" width="1" height="1"></td>
            </tr>
                <tr>
                    <td nowrap="">Fast Transition </td>
                    <td>
                      <input type="checkbox" name="ft" onclick="ft_show()" disabled>
                    </td>
                  </tr>

          </tbody></table>
         </div>

          <div id="ft_box1" style="display:none">
            <table cellpadding="0" cellspacing="0" border="0">

                <tbody><tr>
                    <td nowrap="">Over the DS </td>
                    <td>
                      <input type="checkbox" name="overDs" checked=""> 
                    </td>
                  </tr>
            <tr>
                <td>Reassociation Timeout</td>
                 <td>
          <input type="TEXT" name="reassocTime" size="3" maxlength="3" value="20">Seconds 
         </td></tr>
          </tbody></table>
           </div>

           <div id="w11PFM_Dropdown" style="display: block;">
               <table border="0" cellpadding="0" cellspacing="0">
                   <tbody>
                       <tr>
                           <td class="propertyLabel" colspan="3">Protected Management Frame</td>
                       </tr>
                       <tr>
                           <td colspan="1" class="lineProp"><img alt="" height="1" width="1"></td>
                       </tr>
                       <tr class="notSupported">
                           <td class="propertyLabel2" width="144">PMF</td>
                           <td>
                               <select name="w11pfm" onchange="w11PFMcheckDropDown();OnChangePMFDropDown();" size="1" disabled>
                               <option selected="selected" value="DISABLE">Disabled</option>
                               <option value="OPTIONAL">Optional</option>
                               <option value="REQUIRED">Required</option>
                               </select>
                           </td>
                       </tr>
                   </tbody>
               </table>
           </div>

           <div id="w11akmtime" style="display: none;">

               
               <table border="0" cellpadding="0" cellspacing="0">
                   <tbody>
                       <tr>
                           <td colspan="2">
                               <table border="0" cellpadding="0" cellspacing="0">
                                   <tbody>
                                       <tr>
                                           <td class="propertyLabel2" width="144">Comeback timer(1-10sec)</td>
                                           <td>
                                               <input name="comebacktimer" size="10" maxlength="10" value="1">
                                           </td>
                                       </tr>
                                   </tbody>
                               </table>
                           </td>
                       </tr>
                       <tr>
                           <td colspan="2">
                               <table border="0" cellpadding="0" cellspacing="0">
                                   <tbody>
                                       <tr>
                                           <td class="propertyLabel2" width="144">SA Query Timeout(100-500msec)</td>
                                           <td> 
                                               <input name="retrytimeout" size="10" maxlength="10" value="200"> 
                                           </td> 
                                       </tr>
                                   </tbody> 
                               </table>
                           </td> 
                       </tr>
                   </tbody>
               </table>
             
           </div> 

		  <div id="wep_param_table" style="display:none">
          <table cellpadding="0" cellspacing="0" border="0">
            <tbody><tr>
              <td class="propertyLabel">Static WEP Parameters</td>
              <td>&nbsp;</td>
            </tr>
            <tr id="warnWep128" style="display:none">
              <td class="propertyLabel" colspan="3"><em>WEP key size of 128 bits is not supported on 11xx, 12xx and 13xx model APs. Wlan will not be pushed to these Access Points.</em></td>
            </tr>
            <tr>
              <td colspan="3" class="lineProp"><img alt="" width="1" height="1"></td>
            </tr>
            <tr>
              <td class="propertyLabel2">802.11 Data Encryption</td>
              <td class="list4">Current Key:</td>
              <td class="list4"><input type="text" name="current_key" class="statictextboxlist" readonly="" size="40" maxlength="50" value="None"></td>
            </tr>
            <tr>
              <td>&nbsp;</td><td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td colspan="2">
                <table border="0" cellspacing="1" cellpadding="0">
                  <tbody><tr>
                    <th align="left" class="label1">Type </th>
                    <th align="left" class="label1">Key Size </th>
                    <th class="label1">Key Index </th>
                    <th align="left" class="label1">Encryption Key </th>
                    <th align="left" class="label1">Key Format </th>
                  </tr>
                  <tr>
                    <td class="list4">WEP </td>
                    <td class="list4">
                      <select name="key_size" id="key_size" onchange="changeWepKeyDisplay();" size="1">
						<option value="not_set" selected="">not set</option>
						<option value="size_40">40 bits</option>
						<option value="size_104">104 bits</option>
                     
                     
                     
					  </select>
                    </td>
                    <td class="list4">
                      <select name="WepKeyIndex" size="1">
<option value="1">1
<!-- </option><option value="2">2
</option><option value="3">3
</option><option value="4">4</option> -->
</select>
                    </td>
                    <td class="list4">
                      <input type="text" name="wep_key" size="32" maxlength="32" value="">
                    </td>
                    <td class="list4">
                      <select name="key_format" size="1">
						<option value="format_ascii">ASCII</option>
						<option value="format_hex" selected>HEX</option>
					  </select>
                    </td>
                  </tr>
                </tbody></table>
              </td>
            </tr>
            <tr>
              <td>&nbsp;</td>
            </tr>
            <tr class="notSupported">
              <td class="propertyLabel2" width="144">Allow Shared Key Authentication </td>
              <td>
                <input type="checkbox" name="allow_shared_key_auth" onclick="showElements5()" disabled> &nbsp;Enabled
              </td>
            </tr>
          </tbody></table>
        </div>
		<!--CKIP -->
        <div id="ckip_param_table" style="display:none">
          <table cellpadding="0" cellspacing="0" border="0">
            <tbody><tr>
              <td class="propertyLabel" width="160">CKIP Parameters </td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td colspan="3" class="lineProp"><img alt="" width="1" height="1"></td>
            </tr>
            <tr>
              <td class="propertyLabel2">802.11 Data Encryption </td>
              <td class="list4">Current Key: </td>
              <td class="list4"><input type="text" name="ckip_current_key" class="statictextboxlist" readonly="" size="50" maxlength="50" value="0 bits CKIP Key (Key Index= 0)"></td>
            </tr>
            <tr>
              <td>&nbsp;</td><td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td colspan="2">
                <table border="0" cellspacing="1" cellpadding="0">
                  <tbody><tr>
                    <th align="left" class="label1">Key Size</th>
					<th class="label1">Key Index</th>
					<th align="left" class="label1">Encryption Key</th>
					<th align="left" class="label1">Key Format</th>
                  </tr>
                  <tr>
                    <td class="list4">
                      <select name="ckip_key_size" id="ckip_key_size" onchange="changeCkipKeyDisplay();" size="1">
						<option value="ckip_not_set" selected="">not set</option>
						<option value="ckip_size_40">40 bits</option>
						<option value="ckip_size_104">104 bits</option>
					  </select>
                    </td>
                    <td class="list4">
                      <select name="ckip_key_index" size="1">
						  <option value="ckipindex_1">1</option>
						  <option value="ckipindex_2">2</option>
						  <option value="ckipindex_3">3</option>
						  <option value="ckipindex_4">4</option>
					  </select>
                    </td>
                    <td class="list4">
                      <input type="text" name="ckip_wep_key" size="32" maxlength="32" value="">
                    </td>
                    <td class="list4">
                      <select name="ckip_key_format" size="1">
						  <option value="ckip_format_ascii">ASCII</option>
						  <option value="ckip_format_hex">HEX</option>
					  </select>
                    </td>
                  </tr>
                </tbody></table>
              </td>
            </tr>
            <tr>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td class="propertyLabel2" width="144">MMH Mode</td>
              <td>
                <input type="checkbox" name="ckip_mmhmode" value="disable">&nbsp;Enabled
              </td>
            </tr>
            <tr>
              <td class="propertyLabel2" width="144">Key Permutation</td>
              <td>
                <input type="checkbox" name="ckip_keyperm" value="disable">&nbsp;Enabled
              </td>
            </tr>
          </tbody></table>
        </div>
		<div id="x8021_param_table" style="display:none">
          <table cellpadding="0" cellspacing="0" border="0">
            <tbody><tr>
              <td class="propertyLabel">802.1X Parameters</td>
            </tr>
            <tr id="warnX8021Wep128" style="display:none">
              <td class="propertyLabel" colspan="2"><em>WEP key size of 128 bits is not supported on 11xx, 12xx and 13xx model APs. Wlan will not be pushed to these Access Points.</em></td>
            </tr>
            <tr>
              <td colspan="2" class="lineProp"><img alt="" width="1" height="1"></td>
            </tr>
            <tr>
              <td class="propertyLabel2">802.11 Data Encryption</td>
              <td>
                <table border="0" cellspacing="1" cellpadding="0" width="200">
                  <tbody><tr>
                    <th>&nbsp;</th>
                    <th align="left" class="label1">Type</th>
                    <th align="left" class="label1">Key Size</th>
                  </tr>
				  <!--tr>
              <td class="listNoPad">
                <INPUT type="radio" name="x8021_encryp" value="aes_ocb" >
              </td>
              <td class="list4">AES-OCB</td>
              <td class="list4">128 bits</td>
            </tr-->
                  <tr>
                    <td class="list4">
                      <input type="radio" name="x8021_encryp" value="wep" checked="">
                    </td>
                    <td class="list4">WEP</td>
					  <td class="list4">
						<select name="key_size_8021x" id="key_size_8021x" onchange="wepKeySize8021xSelection()" size="1">
						  <option value="not_set">None</option>
						  <option value="size_40">40 bits</option>
						  <option value="size_104" selected="">104 bits</option>
                     
						</select>
					  </td>
                  </tr>
                  <tr id="note_earlier_128" style="display:none">
                     <td class="propertyLabel" colspan="2" nowrap=""><em>Current Software Version does not support 128 Bit Key Size. Please configure a valid option.</em></td>
                  </tr>
                </tbody></table>
              </td>
            </tr>
          </tbody></table>
        </div>
	<div id="WPA1WPA2_param_table" style="display: inline;">
    <table cellpadding="0" cellspacing="0" border="0">
      <tbody><tr>
        <td class="propertyLabel">WPA+WPA2 Parameters</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td colspan="2" class="lineProp"><img alt="" width="1" height="1"></td>
      </tr>

      <tr>
        <td colspan="2">
          <table cellpadding="0" cellspacing="0" border="0">
            <tbody><tr>
              <td class="propertyLabel2" width="144">WPA Policy</td>
              <td>
              <input type="checkbox" name="wpa1_policy" onclick="showWPA1EncryptionBox();">
              </td>
            </tr>
          </tbody></table>
        </td>
      </tr>

      <tr>
        <td colspan="2">
          <div id="wpa1_encr_box" style="display:none">
            <table cellpadding="0" cellspacing="0" border="0">
              <tbody><tr>
                <td class="propertyLabel2" width="144">WPA Encryption</td>
                <td>
                  <input type="checkbox" name="wpa1_aes_encryption" value="aes" onclick="wpa1EncryptionChecked()" checked="">AES
                  &nbsp; &nbsp; &nbsp;
                  <input type="checkbox" name="wpa1_tkip_encryption" value="tkip" onclick="wpa1EncryptionChecked()" disabled>TKIP
                </td>
              </tr>
            </tbody></table>
          </div>
        </td>
      </tr>

      <tr>
        <td colspan="2">
          <table cellpadding="0" cellspacing="0" border="0">
            <tbody><tr>
              <td class="propertyLabel2" width="144">WPA2 Policy</td>
              <td>
              <input type="checkbox" name="wpa2_policy" onclick="showWPA2EncryptionBox();">
              </td>
            </tr>
          </tbody></table>
        </td>
      </tr>

      <tr>
        <td colspan="2">
          <div id="wpa2_encr_box" style="display: none;">
          <table cellpadding="0" cellspacing="0" border="0">
            <tbody><tr>
               <td class="propertyLabel2" width="144">WPA2 Encryption</td>
               <td>
                 <input type="checkbox" name="wpa2_aes_encryption" value="aes" onclick="wpa2EncryptionChecked()" checked="">AES
                 &nbsp; &nbsp; &nbsp;
                 <input type="checkbox" name="wpa2_tkip_encryption" value="tkip" onclick="wpa2EncryptionChecked()" disabled>TKIP
               </td>
            </tr>
          </tbody></table>
          </div>
        </td>
      </tr>

      <tr>
        <td colspan="2">
          <table cellpadding="0" cellspacing="0" border="0">
<tbody><tr>
          <td colspan="2" class="propertyLabel">Authentication Key Management</td>
        </tr>
        <tr>
          <td colspan="2" class="lineProp"><img height="1" width="1" alt=""></td>
        </tr>
        <tr>
          <td class="propertyLabel2">802.1X </td>
          <td><input type="checkbox" name="DOT1X" value="on" onclick="dot1xDefaultSessionTimeout();">&nbsp;Enable</td>
        </tr>
        <tr class="notSupported">
          <td class="propertyLabel2">CCKM </td>
          <td><input type="checkbox" name="CCKM" value="on" onclick="cckmSecurityChecked();dot1xDefaultSessionTimeout();" disabled="">&nbsp;Enable</td>
        </tr>
        <tr>
          <td class="propertyLabel2">PSK</td>
              <td><input type="checkbox" name="PSK" value="on" onclick="pmfWithPskChecked();pskSecurityChecked();">&nbsp;Enable</td>
                </tr>

            </tbody></table>
        </td>
      </tr>


      <tr>
        <td colspan="2">
          <div id="ft_akm" style="display: block;">
            <table cellpadding="0" cellspacing="0" border="0">

        <tbody class="notSupported"><tr>
          <td class="propertyLabel2">FT 802.1X</td>
                  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="FT_DOT1X" value="on" onclick="ftSecurityChecked();dot1xDefaultSessionTimeout();" disabled="">&nbsp;&nbsp;Enable</td>
                </tr>
        <tr> <td class="propertyLabel2">FT PSK</td>
                  <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" name="FT_PSK" value="on" onclick="ftSecurityChecked();pskSecurityChecked();" disabled>&nbsp;&nbsp;Enable</td>
                </tr>
           </tbody></table>
           </div>
              </td>
            </tr>


         <tr class="notSupported">
             <td colspan="2">
                 <div id="w11akm" style="display: none;">
                     <table border="0" cellpadding="0" cellspacing="0">
                         <tbody class="notSupported">
                             <tr>
                                 <td class="propertyLabel2">PMF 802.1X</td>
                                 <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input name="w11" value="on" type="checkbox" disabled="">&nbsp;&nbsp;Enable</td>
                             </tr>
                             <tr>
                                 <td class="propertyLabel2">PMF PSK</td>
                                 <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input name="w11Psk" value="on" onclick="pskSecurityChecked();pmfwithpmfpskChecked();" type="checkbox" disabled>&nbsp;&nbsp;Enable</td>
                             </tr>
                         </tbody>
                     </table>
                 </div>
             </td>
         </tr>

      <tr>
        <td colspan="2">
          <div id="wpa_key_mgmt_psk_box" style="display: block;">
            <table cellpadding="0" cellspacing="0" border="0">
              <tbody><tr>
                <td class="propertyLabel2" width="144">PSK Format</td>
                <td>
                  <select name="akm_psk_format" size="1" disabled>
                    <option value="format_ascii" selected>ASCII</option>
                    <option value="format_hex">HEX</option>
                  </select>
                </td>
              </tr>
              <tr>
                <td> &nbsp; </td>
                <td>
                  <input type="Password" name="akm_psk_key" emweb_type="PASSWORD" autocomplete="off" size="64" maxlength="64" value="">
                  <!--<INPUT type="text" name="key_status" class="statictextboxDojo" readonly SIZE="18" MAXLENGTH="18" VALUE="PSK is currently set .">-->
                </td>
              </tr>
             </tbody></table>
            </div>
           </td>
         </tr>
   <!-- gtk enable -->
    <tr class="notSupported">
      <td class="propertyLabel2" width="144" nowrap="nowrap">WPA gtk-randomize State
         <sup title="See foot note below" onclick="alert('See foot note below');">14</sup>
      </td>
       <td> <select name="wpa_gtk_state" size="1" disabled>
            <option value="Enable">Enable</option>
            <option value="Disable" selected="">Disable</option>
            </select>
       </td>
    </tr>
    </tbody></table>
  </div>

        <!----- End of IF GUEST ------->
      </div>
    </div>
	<!----------- end 'Layer 2' tab --------->

	<!-------- Start 'Layer 3' tab in 'Security' tab --- -->
	<div id="sectab2" dojotype="ContentPane" label="Layer 3" style="top: 0px; left: 0px; width: 100%; height: 375px; display: none;" class="dojoTabPane">
       <div class="tabcontent">
        <table border="0" cellspacing="0" cellpadding="0">
 
     
            <tbody><tr>
              <td class="propertyLabel2">Layer 3 Security
              
             <sup title="See foot note below" onclick="alert('See foot note below');">1</sup> 
              
               <select name="sIPsec" onclick="notSupported(); return false; //checkDropDown2();changeDefaults();security_web_checked()">
               <option value="vpn_none" selected="">None</option>
               <option value="security_web">Web Policy</option>	
        	
              </select>
            </td>
		</tr>
    <!-- IF NOT SMB -->
  <!-- IF WLAN IS WIRELESS -->

            <tr>
            <td colspan="0">
              <div id="select_web_options" style="display: none;">
                <table border="0" cellspacing="0" cellpadding="0">
                 <tbody><tr>
                    <td class="propertyLabel2">
                        <input type="radio" name="security_web_options" value="web_auth" onclick="showElementsWeb()" checked="">&nbsp;Authentication
                    </td>
                 </tr>
				 <tr>
                    <td class="propertyLabel2">
                        <input type="radio" name="security_web_options" value="web_passthrough" onclick="showElementsWeb()">&nbsp;Passthrough
                    </td>
				 </tr>
     
                 <tr>
                    <td class="propertyLabel2">
                        <input type="radio" name="security_web_options" value="web_redirect" onclick="showElementsWeb()">&nbsp;Conditional Web Redirect
                    </td>
                 </tr>
                 <tr>
                    <td class="propertyLabel2">
                        <input type="radio" name="security_web_options" value="web_splash_page_redirect" onclick="showElementsWeb()">&nbsp;Splash Page Web Redirect
                    </td>
                 </tr>
                 <tr>
                    <td class="propertyLabel2">
                        <input type="radio" name="security_web_options" value="web_OnMacFilterFailure" onclick="showElementsWeb()">&nbsp;On MAC Filter failure<sup title="See foot note below" onclick="alert('See foot note below');">10</sup>
                    </td>
                 </tr>
      <!-- NOT SMB -->
     <!-- IF WIRELESS -->
              <tr id="select_acl" style="display: none;"> 
                  <td class="propertyLabel2">Preauthentication ACL  &nbsp;&nbsp;</td>   
	            <td>&nbsp;&nbsp;&nbsp; IPv4 
	                 <select name="aclName">
<option value="" selected="">None</option></select> 
	            </td> 
	            <td id="ipv6_acl">&nbsp;&nbsp;&nbsp; IPv6 
	                 <select name="aclNamev6">
<option value="" selected="">None</option></select> 
	            </td> 
                  
                    <td>&nbsp;&nbsp;&nbsp; WebAuth FlexAcl
                         <select name="webauth_acl">
<option value="" selected="">None</option></select>
                    </td>

                   <!-- IF WIRELESS -->
	          </tr>
              <tr>
	             <td class="propertyLabel2"> 
	               <div id="select_emailinput" style="display: none;"> 
	                  &nbsp;&nbsp; <input type="checkbox" name="web_emailinput">&nbsp;Email Input 
	               </div> 
	             </td> 
	          </tr>	   
  
             <tr> 
                <td class="propertyLabel2">
	         <div id="select_sleepclient"> 
                   Sleeping Client &nbsp;<input type="checkbox" name="sleep_client" onclick="showSleepingTimeout()"> &nbsp;Enable
	         </div> 
                </td> 
             </tr>
             <tr> 
                <td class="propertyLabel2">
	         <div id="select_sleeptime"> 
                   Sleeping Client Timeout(10 to 43200 Min) &nbsp;<input type="TEXT" name="sleep_timeout" class="statictextboxlist" size="4" maxlength="5" value="720">
	        </div> 
                </td> 
            </tr>       

     
	          <tr> 
                 <td class="propertyLabel2"> 
                   <div id="select_ogcenable" style="display: none;">  
                      Over-ride Global Config&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input name="Over_ride_global_config" onclick="ogc_checked();" type="checkbox">&nbsp;Enable
	               </div> 
                 </td> 
              </tr>
      <!-- NOT SMB -->
	          	          
              <tr style="display: none;" id="select_ogc"> 
              <td width="160" class="propertyLabel2">Web Auth type</td> 
                <td> 
                  <select name="WATName" id="webauthtypeid" onchange="create_dropdown();">
                    <option value="Internal" selected="selected">Internal</option>
                    <option value="Customized">Customized(Downloaded)</option>
                    <option value="External">External(Re-direct to external server)</option>
                  </select> 
                </td> 
              </tr>
              <tr style="display: none;" id="login_page"> 
		<td class="propertyLabel2">Login Page</td>
                <td>
		<select name="loginPageName">
<option value="" selected="">None</option></select>
                </td> 
              </tr>
              <tr style="display: none;" id="login_failure_page"> 
     		<td class="propertyLabel2">Login Failure page</td> 
                <td>
		<select name="login_failure_page">
<option value="" selected="">None</option></select>
                </td>
              </tr>
              <tr style="display: none;" id="logout_page"> 
            <td class="propertyLabel2">Logout page</td> 
                <td>
		<select name="logout_page">
<option value="" selected="">None</option></select>
                </td> 
              </tr>
	          
              <tr style="display: none;" id="url_id"> 
                <td class="propertyLabel2">URL </td>
                <td>
                  <input name="url_textbox" type="text" size="50" maxlength="254" value="">
                </td> 
              </tr>


	         </tbody></table> 
	        </div> 
	        </td> 
           </tr>
 
          </tbody></table>



 
  <div id="ipsec_param_table" style="display: none;">
    <table cellpadding="0" cellspacing="0" border="0">

      <tbody><tr>
        <td class="propertyLabel" width="160">IPsec Parameters</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td colspan="3" class="lineProp"><img alt="" width="1" height="1"></td>
      </tr>
      <tr>
        <td class="propertyLabel2">IPsec Authentication</td>

        <td>
          <select name="vap_vpn_auth" size="1">
            <option value="HmacMd5">HMAC MD5</option>
            <option value="HmacSha1" selected="">HMAC SHA1</option>
          </select>
        </td>
      </tr>

      <tr>
        <td class="propertyLabel2">IPsec Encryption</td>
        <td>
          <select name="vap_vpn_encryp" size="1">

            <option value="Des">DES</option>
            <option value="TrippleDes" selected="">3DES</option>
            <option value="AesCbc">AES 128 CBC</option>

          </select>
        </td>
      </tr>
    <input type="hidden" name="ipsec_key_size" value="0">
      <tr>
        <td class="propertyLabel2">IKE Authentication</td>
        <td><div><table><tbody><tr>
			<td class="list4">Current Setting: <input type="text" name="current_ikeauth_type" class="statictextboxlist" readonly="" size="40" maxlength="50" value="XAuth Pre-shared Key, key is not set"></td>
			</tr></tbody></table> </div>
		</td>
	  </tr>
      <tr>
         <td>&nbsp;</td>
         <td>&nbsp;</td>
      </tr>
      <tr><td>&nbsp;</td>
        <td>
          <table border="0" cellspacing="1" cellpadding="0">
            <tbody><tr>
              <th>&nbsp;</th>

              <th align="left" width="140" class="label1">Type</th>
              <th align="left" class="label1">Key</th>
            </tr>
            <tr>
              <td class="list4">
                <input type="radio" name="vap_vpn_ike_auth" value="Certificates">
              </td>
              <td class="list4">Certificates</td>

              <td class="list4">&nbsp;</td>
            </tr>
            <tr>
              <td class="list4">
                <input type="radio" name="vap_vpn_ike_auth" value="Key">
              </td>
              <td class="list4" nowrap="">Pre Shared Key</td>
              <td class="list4">
                <input type="Password" name="preshared_key" autocomplete="off" size="40" maxlength="128" value="">
              </td>
            <!--<td>
                <INPUT type="text" class="statictextboxDojo" readonly name="presharedKey_is_set" SIZE="21" MAXLENGTH="20" VALUE="">
            </td>-->
            </tr>
            <tr>
              <td class="list4">
                <input type="radio" name="vap_vpn_ike_auth" value="XauthPsk" checked="">
              </td>
              <td class="list4" nowrap="">XAuth Pre Shared Key</td>
              <td class="list4">
                <input type="Password" name="XauthPsk_key" autocomplete="off" size="40" maxlength="128" value="">
              </td>
              <!--<td>
                <INPUT type="text" class="statictextboxDojo" readonly name="xauthKey_is_set" SIZE="21" MAXLENGTH="20" VALUE="(Key is NOT set)">
              </td>-->
            </tr>

          </tbody></table>
        </td>
      </tr>
      <tr>
        <td class="propertyLabel2">IKE Phase 1</td>
        <td>
          <select name="vap_vpn_ike_phase1" size="1">
            <option value="Aggressive" selected="">Aggressive</option>
            <option value="Main">Main</option>

          </select>
        </td>
      </tr>
      <tr>
        <td class="propertyLabel2">Lifetime (seconds)</td>
        <td>
          <input type="TEXT" name="vap_timeout_value" size="16" maxlength="15" value="0">
        </td>
      </tr>
      <tr>
        <td class="propertyLabel2" nowrap="">IKE Diffie Hellman Group</td>
        <td>
          <select name="vap_vpn_ike_dhgroup" size="1">
            <option value="group1">Group 1 (768 bits)</option>
            <option value="group2" selected="">Group 2 (1024 bits)</option>
            <!--option value="group3">Group 3(ECC ??? bits)</option-->
            <!--option value="group4">Group 4(ECC ??? bits)</option-->
            <option value="group5">Group 5 (1536 bits)</option>
          </select>
        </td>
      </tr>
      <tr>                    
        <td class="propertyLabel2">Contivity Mode</td>
        <td>
          <table>
          <tbody><tr>
          <td>
          <input type="checkbox" name="vap_qotd_mode" onclick="enableQotdServer()"> Enabled
          </td>
          <td>
          <div id="qotd_server_box" style="display:none;">
            <table>
              <tbody><tr>                
                <td>
                  <input type="text" name="vap_qotd_addr" size="32" maxlength="15" value="0.0.0.0">
                </td>
               </tr>
                  <tr>
                    <td nowrap="">&nbsp;QOTD Server Address</td>
                  </tr>               
            </tbody></table>
          </div>
        </td>
        </tr>
        </tbody></table>
        </td>        
      </tr>      
    </tbody></table>
  </div>
  <div id="l2tp_param_table" style="display: none;">
    <table cellpadding="0" cellspacing="0" border="0">

      <tbody><tr>
        <td class="label1" width="160">L2TP Parameters</td>
        <td width="160">&nbsp;</td>
      </tr>
      <tr>
        <td colspan="3" class="horizLine"><img alt="" width="1" height="1"></td>
      </tr>
      <tr>
        <td class="propertyLabel2">IPsec Authentication</td>

        <td>
          <select name="l2tp_vap_vpn_auth" size="1">
            <option value="HmacMd5">HMAC MD5</option>
            <option value="HmacSha1" selected="">HMAC SHA1</option>
          </select>
        </td>
      </tr>

      <tr>
        <td class="propertyLabel2">IPsec Encryption</td>
        <td>
          <select name="l2tp_vap_vpn_encryp" size="1">

            <option value="Des">DES</option>
            <option value="TrippleDes" selected="">3DES</option>
            <option value="AesCbc">AES 128 CBC</option>

          </select>
        </td>
      </tr>
    </tbody></table>
    <table cellpadding="0" cellspacing="0" border="0">
    <input type="hidden" name="l2tp_ipsec_key_size" value="0">
      <tbody><tr>
        <td class="propertyLabel2" width="145">IKE Authentication</td>
        <td class="list4">Current Setting: <input type="text" name="l2tp_current_ikeauth_type" class="statictextboxlist" readonly="" size="50" maxlength="50" value="XAuth Pre-shared Key, key is not set"></td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr><td>&nbsp;</td>
        <td>
          <table border="0" cellspacing="1" cellpadding="0">
            <tbody><tr>
              <th>&nbsp;</th>

              <th align="left" width="140">Type</th>
              <th align="left">Key</th>
            </tr>
            <tr>
              <td class="listNoPad">
                <input type="radio" name="l2tp_vap_vpn_ike_auth" value="Certificates">
              </td>
              <td class="list4">Certificates</td>
              <td class="list4">&nbsp;</td>
            </tr>
            <tr>
              <td class="listNoPad">
                <input type="radio" name="l2tp_vap_vpn_ike_auth" value="Key" checked="">
              </td>
              <td class="list4" nowrap="">Pre Shared Key</td>
              <td class="listNoPad">
                <input type="Password" name="l2tp_preshared_key" autocomplete="off" size="40" maxlength="128" value="">
              </td>
            <td>
                <input type="text" class="statictextbox" readonly="" name="l2tp_presharedKey_is_set" size="21" maxlength="20" value="">
            </td>
            </tr>
          </tbody></table>
        </td>
      </tr>
      <tr>
        <td class="propertyLabel2">IKE Phase 1</td>
        <td>
          <select name="l2tp_vap_vpn_ike_phase1" size="1">
            <option value="Main" selected="">Main</option>

          </select>
        </td>
      </tr>
      <tr>
        <td class="propertyLabel2">Lifetime (seconds)</td>
        <td>
          <input type="TEXT" name="l2tp_vap_timeout_value" size="16" maxlength="15" value="0">
        </td>
      </tr>
      <tr>
        <td class="propertyLabel2">IKE Diffie Hellman Group</td>
        <td>
          <select name="l2tp_vap_vpn_ike_dhgroup" size="1">
            <option value="group1">Group 1 (768 bits)</option>
            <option value="group2" selected="">Group 2 (1024 bits)</option>
            <!--option value="group3">Group 3(ECC ??? bits)</option-->
            <!--option value="group4">Group 4(ECC ??? bits)</option-->
            <option value="group5">Group 5 (1536 bits)</option>
          </select>
        </td>
      </tr>
    </tbody></table>
  </div>
   <!-- IF NOT BRANCHOFFICE -->
   <!-- IF NOT BRANCHOFFICE -->
  <!-- IF NOT SMB -->
 <!-- End of EMWEB IF WIRELESS -->
	  </div>
    </div>
	
	<!----------- Start 'AAA Servers' tab in 'Security' tab ------->
	<div id="sectab3" dojotype="ContentPane" label="AAA Servers" style="top: 0px; left: 0px; width: 100%; height: 375px; display: none;" class="dojoTabPane">
      <div class="tabcontent">
        <table cellspacing="0" cellpadding="0" border="0">
          <tbody><tr>
             <td colspan="2" class="propertyLabel">Select AAA servers below to override use of default servers on this WLAN</td>
          </tr>
         </tbody></table>
	  <table cellspacing="0" cellpadding="0" border="0">
              <tbody><tr>
                  </tr></tbody></table><table cellspacing="0" cellpadding="0" border="0">
                    <tbody><tr>
                      <td class="propertyLabel">Radius Servers </td>
                    </tr>

            
                     <tr class="notSupported">
                       <td nowrap="" class="propertyLabel2">Radius Server Overwrite interface &nbsp;&nbsp;
                        <input type="checkbox" name="overwrite_int" id="overwrite_int" value="disable" onclick="setRadiusIntPriority();">Enabled
                       </td>
                     </tr>
                     <tr>
                       <td colspan="2">
                         <div id="intPriDiv" style="display:none">
                           <table border="0" cellspacing="0" cellpadding="0">
                             <tbody><tr>
                               <td nowrap="" class="propertyLabel2">Interface Priority</td>
                               <td>
          		         <select name="int_priority" size="1">
            		           <option value="wlan" selected="">WLAN</option>
            		           <option value="ap_group">AP Group</option>
          		         </select>
                               </td>
                             </tr>
                          </tbody></table>
                        </div>
                      </td>
                     </tr>
             

                    <tr>
                      <td class="horizLine"><img alt="" width="1" height="1"></td>
                      <td width="40">&nbsp;</td>
                      <td class="horizLine"><img alt="" width="1" height="1"></td>
                    </tr>
                    <tr>
                      <td valign="top">
                      <table border="0" cellspacing="0" cellpadding="0">
                      <tbody><tr>
		      <td></td>
                      <td class="propertyLabel" nowrap="">Authentication Servers </td>
		
                      <td class="propertyLabel" nowrap="">Accounting Servers </td>
		
                       </tr>
					<tr>
					  <td>&nbsp;</td>
					  <td align="left" class="notSupported"><input type="checkbox" name="auth_enable" onclick="setAuthenticatingState();" checked=""> Enabled</td>
		
					  <td align="left" class="notSupported"><input type="checkbox" name="acc_enable" onclick="setAccountingState();"> Enabled</td>
		
					</tr>
					<tr>
						<td class="propertyLabel2">Server 1</td>
						<td><select name="auth_server_1">
<option value="0" selected="">None</option></select></td>
		
						<td class="notSupported"><select name="acc_server_1">
<option value="none" selected="">None</option></select></td>
		
					</tr>
					<tr class="notSupported">
						<td class="propertyLabel2">Server 2</td>
						<td><select name="auth_server_2">
<option value="none" selected="">None</option></select></td>
		
						<td><select name="acc_server_2">
<option value="none" selected="">None</option></select></td>
		
					</tr>
					<tr class="notSupported">
						<td class="propertyLabel2">Server 3</td>
						<td><select name="auth_server_3">
<option value="none" selected="">None</option></select></td>
		
						<td><select name="acc_server_3">
<option value="none" selected="">None</option></select></td>
		
					</tr>
					<tr class="notSupported">
						<td class="propertyLabel2">Server 4</td>
						<td><select name="auth_server_4">
<option value="none" selected="">None</option></select></td>
		
						<td><select name="acc_server_4">
<option value="none" selected="">None</option></select></td>
		
					</tr>
					<tr class="notSupported">
						<td class="propertyLabel2">Server 5</td>
						<td><select name="auth_server_5">
<option value="none" selected="">None</option></select></td>
		
						<td><select name="acc_server_5">
<option value="none" selected="">None</option></select></td>
		
					</tr>
					<tr class="notSupported">
						<td class="propertyLabel2">Server 6</td>
						<td><select name="auth_server_6">
<option value="none" selected="">None</option></select></td>
		
						<td><select name="acc_server_6">
<option value="none" selected="">None</option></select></td>
		
					</tr>
				</tbody></table>
                           </td>
            

                          <td width="40">&nbsp;</td>
                          <td valign="top">
                          <div id="eap_parameters" style="display:none">
                          <table cellspacing="0" cellpadding="0" border="0" class="notSupported">
                           <tbody><tr><td class="propertyLabel">EAP Parameters</td></tr>
                           <tr>
                            <td class="label2">Enable &nbsp; &nbsp; &nbsp; &nbsp;
                               <input type="checkbox" name="eap_enable" id="eap_enable" onclick="showEapParams();"></td>
                          </tr>
                          <tr>
                          <td valign="top"> 
                          <div id="eap_parms" style="display:none">
                          <table cellspacing="0" cellpadding="0" border="0">
                           <tbody><tr>
                              <td class="label2">EAPOL Key Timeout(200 to 5000 millisec)</td>
                              <td><input type="text" name="eap_timeout" size="4" maxlength="4" value="1000"></td>
                           </tr>
                           <tr>
                              <td class="label2">EAPOL Key Retries(0 to 4)</td>
                              <td><input type="text" name="eap_retries" size="4" maxlength="4" value="2"></td>
                           </tr>
                           <tr>
                              <td class="label2">Identity Request Timeout(1 to 120 sec)</td>
                              <td><input type="text" name="identity_timeout" size="4" maxlength="4" value="30"></td>
                           </tr>
                           <tr> 
                              <td class="label2">Identity Request Retries(1 to 20)</td>
                              <td><input type="text" name="identity_retries" size="4" maxlength="4" value="2"></td>
                           </tr>
                           <tr>
                              <td class="label2">Request Timeout(1 to 120 sec)</td>
                              <td><input type="text" name="req_timeout" size="4" maxlength="4" value="30"></td>
                           </tr>
                           <tr>
                              <td class="label2">Request Retries(1 to 20)</td>
                              <td><input type="text" name="req_retries" size="4" maxlength="4" value="2"></td>
                           </tr>                           
                          </tbody></table>
                          </div>
                          </td>
                          </tr>
                          </tbody></table>
                         </div></td>
                         
		
                   </tr>
                  </tbody></table>
                  
                   
                    
		<table cellspacing="0" nowrap="" cellpadding="0" border="0" class="notSupported">
                    <tbody><tr>
                       <td nowrap="" class="propertyLabel">Radius Server Accounting </td>
                       <td width="160">&nbsp;</td>
                     </tr>
                     <tr>
                       <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                     </tr>
                     <tr>
                       <td nowrap="" class="propertyLabel2" width="145">Interim Update </td>
                       <td>
                         <input type="checkbox" name="interim_update" onclick="showInterimInterval();">                       </td>
                     
		       <td>
		       <div id="interim_interval_div" style="display:none">
		         <table border="0" cellspacing="0" cellpadding="0">
			  <tbody><tr>
                           <td> Interim Interval </td>
			   <td>
			   <input type="TEXT" name="interim_interval" size="5" maxlength="4" value="0">		                </td> 
                          </tr>
			</tbody></table>
                      </div>
		     </td>
		    </tr>
                 </tbody></table>  

               <table cellspacing="0" nowrap="" cellpadding="0" border="0" class="notSupported">
                 <tbody><tr>
                   <td class="propertyLabel" colspan="3">LDAP Servers </td>
                    </tr>
                    <tr>
                      <td class="lineProp" colspan="3"><img alt="" width="1" height="1"></td>
                 </tr>
				 <tr>
					<td class="propertyLabel2">Server 1</td>
					<td><select name="ldap_server_1">
<option value="none" selected="">None</option></select></td>
				</tr>
				<tr>
					<td class="propertyLabel2">Server 2</td>
					<td><select name="ldap_server_2">
<option value="none" selected="">None</option></select></td>
				</tr>
	            <tr>
					<td class="propertyLabel2">Server 3</td>
					<td><select name="ldap_server_3">
<option value="none" selected="">None</option></select></td>
				</tr>
				</tbody></table>


		<table cellspacing="0" nowrap="" cellpadding="0" border="0" class="notSupported">

                    <tbody><tr>
                       <td nowrap="" class="propertyLabel">Local EAP Authentication </td>
                       <td width="160">&nbsp;</td>
                     </tr>
                     <tr>
                       <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                     </tr>
                     <tr>
                       <td nowrap="" class="propertyLabel2">Local EAP Authentication </td>
                       <!-- Unit -->
                       <td>
                         <input type="checkbox" name="local_auth" id="local_auth" onclick="displayProfile();">Enabled
                       </td>
                     </tr>
					 <tr><td colspan="2">
						<div id="profile_div" style="display:none">
						<table border="0" cellspacing="0" cellpadding="0">
						<tbody><tr>
							<td class="propertyLabel2" width="145"><label for="eap_profile">EAP Profile Name</label></td>
							<td><select name="eap_profile" id="eap_profile"></select></td>
						</tr>
						</tbody></table>
						</div>
						</td>
					</tr>

					<tr>
                        <td colspan="2">&nbsp;</td>
                     </tr>
                 </tbody></table>                               

<!-----------Code for Server-precedence setting ------->

    <table cellspacing="0" cellpadding="0" border="0" class="notSupported">
   
	<tbody><tr>
          <td colspan="2" class="label1">Authentication priority order for web-auth user</td>
	</tr>
	<tr>
	    <td colspan="2" class="horizLine"><img alt="" height="1" width="250"></td>
	</tr>
	<tr><td>&nbsp;</td></tr>
    <tr>
                    <td nowrap="" class="label2" align="middle"><b>Not Used</b></td>
                    <td align="middle">&nbsp; </td>
                    <td nowrap="" class="label2" align="middle"><b>Order Used For Authentication</b></td>
    </tr>
    <tr>
          <td style="width:20%" align="middle">
              <select class="navBar" multiple="" name="auth_prty1a" alt="priority order" size="3"></select> 
          </td>

          <td width="20%" align="middle">
          <table>
              <tbody>
              <tr>
                 <td><input style="WIDTH: 50px" onclick="Selectbox.moveSelectedOptions(this.form.auth_prty1a,this.form.auth_prty2a,this.form.movesort.checked)" type="button" value=">" name="show"></td>
              </tr>
              <tr>
                  <td><input style="WIDTH: 50px" onclick="Selectbox.moveSelectedOptions(this.form.auth_prty2a,this.form.auth_prty1a,this.form.movesort.checked)" type="button" value="<" name="hide"></td>
              </tr>

              </tbody>
           </table>
           </td>
           <td style="width:20%" align="middle">
               <select class="navBar" multiple="" name="auth_prty2a" alt="priority order" size="3">
<option value="3">LOCAL
</option><option value="2">RADIUS
</option><option value="1">LDAP</option></select> 
           </td>
           <td align="left" width="40%">
            <table>

              <tbody>
              <tr>
                <td><input style="WIDTH: 50px" onclick="Selectbox.moveOptionUp(this.form.auth_prty2a)" type="button" value="Up" name="button"> 
                </td>
              </tr>
              <tr>
                <td><input style="WIDTH: 50px" onclick="Selectbox.moveOptionDown(this.form.auth_prty2a)" type="button" value="Down" name="button"> 
                </td>
              </tr>
              </tbody>
			</table>

       </td></tr><tr>
		  <td colspan="3" style="padding-top:10%">
		    <table cellpadding="0" cellspacing="0" border="0">
		        <tbody><tr>
		           <td class="horizLine"><img alt="" width="1" height="1"></td>
		        </tr>

		    </tbody></table>
		  </td>
	   </tr><tr>
       </tr><tr>
         <td><input name="movesort" type="hidden" value="true"></td>
       </tr>
       </tbody></table>


<!-----------Code for Server-precedence setting ------->




              
              
             
           </div>
		</div>
		<!---------- end 'AAA Servers' tab -------------->
    </div>
</div>
	</div>
	<!---------- end 'Security' tab ----------->

	<!---------- Start 'QoS' tab -------------->
	<div id="tab4" dojotype="ContentPane" label="QoS" style="top: 0px; left: 0px; width: 100%; height: 425px; display: none; overflow: auto" class="dojoTabPane">
      <div class="tabcontent">
		<table cellspacing="0" cellpadding="0" border="0" class="notSupported">

		<tbody><tr>
			<td class="propertyLabel2">Quality of Service (QoS)</td>
			<!-- Unit -->
			<td>
			  <select name="vap_qos" disabled>                
                <option value="Platinum">Platinum (voice)</option>
                <option value="Gold">Gold (video)</option>
                <option value="Silver" selected="">Silver (best effort)</option>
                <option value="Bronze">Bronze (background)</option>
              </select>      
			</td>
		</tr>
 <!--IF_REMOTE_LAN -->

                 <tr>
                    <td class="propertyLabel2">Application Visibility</td>
                    <td>
                        <input type="checkbox" name="nbarEnabled" id="nbarEnabled" disabled>&nbsp;Enabled
                    </td>
                </tr>

                
                <tr id="avc_profileShow">
                    <td class="propertyLabel2">AVC Profile</td>
                    <td><select name="avcprofile" id="avcprofile" onchange="avc_assoc();" disabled>
<option value="none" selected="">none</option></select></td>
                </tr>
                		
                
                
                
                

                
                <tr id="net_flowShow">
                    <td class="propertyLabel2">Netflow Monitor</td>
                    <td><select name="netFlow" id="netFlow" disabled>
<option value="none" selected="">none</option></select></td>
                 </tr>
               




          </tbody></table><table border="0" cellspacing="0" cellpadding="0" class="notSupported">
		<tbody><tr>
			<td class="propertyLabel" width="160">WMM</td>
			<td width="200">&nbsp; </td>
		</tr>
		<tr>
			<td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
		</tr>     
		<tr>
			<td class="propertyLabel2">WMM Policy</td>
			<!-- WME -->
			<td>
			  <select name="vap_wme" disabled>
                <option value="Disabled">Disabled</option>
                <option value="Allowed" selected="">Allowed</option>
                <option value="Required">Required</option>
              </select>
            </td>
         </tr>
		 <tr>
		  <td class="propertyLabel2">7920 AP CAC</td>
		  <td>
			<table border="0" cellspacing="0" cellpadding="0">
			  <tbody><tr>
				<td>
				  <input type="checkbox" name="ap_cac_limit" value="enable" disabled>&nbsp;
				  Enabled
				</td>
			  </tr>
			</tbody></table>
		  </td>
		</tr>
		<tr id="cacClient7920">
		  <td class="propertyLabel2">7920 Client CAC</td>
		  <td>
			<table border="0" cellspacing="0" cellpadding="0">
			  <tbody><tr>
				<td>
				  <input type="checkbox" name="client_cac_limit" value="enable" disabled>&nbsp;
				  Enabled
				</td>
			  </tr>
			</tbody></table>
		  </td>
		</tr>                
			<tr>
			<td colspan="2">&nbsp; </td>			
		</tr>
                     
    
    
         </tbody></table>
           
         

        
  
  <!--IF_REMOTE_LAN -->
	  
	  </div>
   </div>
   <!-------- end 'QoS' tab ----------->
 <!--IF_REMOTE_LAN -->

        <!---------- Start 'Policy Mapping' tab -------------->
        <div id="tab6" dojotype="ContentPane" label="Policy-Mapping" style="top: 0px; left: 0px; width: 100%; height: 425px; display: none; overflow: auto" class="dojoTabPane">
      <div id="policyTab" class="tabcontent">
        <table cellspacing="0" cellpadding="0" border="0" class="notSupported">
        <tbody><tr>
            <td class="label2" width="200">Priority Index (1-16)</td>
            <td>
                <input type="TEXT" name="pri_new" id="pri_new" size="3" maxlength="2" value="" disabled>
            </td>
        </tr>
        <tr>
          <td class="label2">Local Policy</td>
            <td>
              <select name="policy_new" id="policy_new" disabled></select>
           </td>
        </tr>
        <tr>
            <td>&nbsp;</td>
            <td><br>
               <input type="button" name="newPolicyInWlan" value="Add " class="buttonstretch" onclick="addPolicyToWlan()" disabled>    

            </td>
        </tr>
        </tbody></table>

      <table width="600" border="0" cellspacing="0" cellpadding="0" class="notSupported">
        <tbody><tr>
            <td style="padding-top: 13px">
                <table width="600" border="0" cellspacing="0" cellpadding="0">
                    <tbody><tr>
                        <th align="left" width="50">Priority Index</th>
                        <th align="left" width="50">Local Policy Name</th>
                        <th align="left" width="1">&nbsp;</th>
                    </tr>

                </tbody></table>
            </td>
        </tr>
    </tbody></table>
   </div>
   </div>
   <!-------- end 'Policy Mapping' tab ----------->
   <!-------- Start 'Advanced' tab ---->

   <div id="tab5" dojotype="ContentPane" label="Advanced" style="top: 0px; left: 0px; width: 100%; height: 425px; display: none; overflow: auto" class="dojoTabPane">
	 <div class="tabcontent">
		<table>
			<tbody><tr>
			  <td valign="top" width="50%">
                <table cellspacing="0" cellpadding="0" border="0">
				<tbody><tr class="notSupported">
                      <td class="propertyLabel2">Allow AAA Override</td>
                      <td>
                        <input type="checkbox" name="vap_radius_override" value="enable">&nbsp;Enabled
                      </td>
                </tr>
                 
                <tr class="notSupported">
                      <td class="propertyLabel2">Coverage Hole Detection</td>
                      <td>
                        <input type="checkbox" name="chd_enable" value="enable" checked="" disabled>&nbsp;Enabled
                      </td>
                </tr>
                                
		        <tr class="notSupported">
                 <td colspan="2"> 
		           <table border="0" cellspacing="0" cellpadding="0" class="notSupported">
                     <tbody><tr>
			          <td class="propertyLabel2" width="144">Enable Session Timeout </td>
				      <td>
                          <input type="checkbox" name="vap_session_timeout_chkbx" onclick="showVapSessionTimeOut(true);" value="disable" disabled>
                      </td>
                      <td>
                         <div id="vap_session_id" style="display:none">
                             <table border="0" cellspacing="0" cellpadding="0">
                               <tbody><tr>
                                  <td>
                                      <input type="TEXT" name="vap_session_timeout" size="9" maxlength="5" value="0" disabled>
                                  </td>
                               </tr>
                               <tr>
                                   <td nowrap="">&nbsp; Session Timeout (secs)</td>
                               </tr>
                             </tbody></table>
                          </div>
				       </td>
				     </tr>
                    </tbody></table>
                   </td>
                 </tr>


				<tr class="notSupported">
					<td class="propertyLabel2">Aironet IE</td>
					<td><input type="checkbox" name="aironetIe" checked="" disabled>Enabled</td>
				</tr>
				<tr class="notSupported">
					<td class="propertyLabel2">Diagnostic Channel
					<sup title="See foot note below" onclick="alert('See foot note below');">18</sup>
					</td>
					<td><input type="checkbox" name="diag_cha" onclick="hideSnooping();diagChannelConfigAlert();" disabled>Enabled</td>
				</tr>

				<tr>
     <!--IF_WLAN_IS_WIRELESS -->
				</tr><tr class="notSupported">            
				   <td class="propertyLabel2">Override Interface ACL </td> 
					<td>IPv4 
						<select name="aclPerWlan" disabled>
<option value="" selected="">None</option></select>
					</td>


					<td>IPv6 
						<select name="aclPerWlanv6" disabled>
<option value="" selected="">None</option></select>
					</td>


				</tr>

                <tr class="notSupported">
                   <td class="propertyLabel2">Layer2 Acl </td>
                    <td>
                       <select name="l2acl" onchange="checkLearnIPAgainstL2Acl()" disabled>
<option value="" selected="">None</option></select>
                    </td>
                </tr>
			    <tr class="notSupported">            
					<td class="propertyLabel2">P2P Blocking Action </td>
					<td>
			           <select name="P2PBlockingMode" disabled>
                               <option value="Disabled" selected="">Disabled</option>
                               <option value="Drop">Drop</option>
                               <option value="ForwardUp">Forward-UpStream</option>
					   </select>
					</td>
				</tr>

 
				  <tr class="notSupported">
					  <td class="propertyLabel2" width="144">Client Exclusion <sup title="See foot note below" onclick="alert('See foot note below');">
							  3</sup> 
                      </td>
					  <td>
					    <table border="0" cellspacing="0" cellpadding="0">
					    <tbody><tr>
						   <td>
							<input type="checkbox" name="vap_blacklist" onclick="showElements5()" checked="" disabled>Enabled &nbsp;&nbsp;&nbsp;
						  </td>
						  <td>
					        <div id="blacklist_id_box" classname="visioff" style="display: inline;">
						       <table cellpadding="0" cellspacing="0" border="0">
						         <tbody><tr>
							       <td>
							         <input type="TEXT" name="vap_blacklist_timeout" size="16" maxlength="15" value="60" disabled>
							       </td>
						         </tr>
						         <tr>
							       <td nowrap="">&nbsp;Timeout Value (secs)</td>
						         </tr>
						        </tbody></table>
					        </div>
					      </td>
				        </tr>
				      </tbody></table>
				     </td>
				   </tr>
				    <!--USMWEB_IF_NOT_DATA_ONLY -->

                                   <tr class="notSupported">
                                      <td class="propertyLabel2">Maximum Allowed Clients 
                                      <sup title="See foot note below" onclick="alert('See foot note below');">8</sup>
                                      </td>
                                      <td>
                                      <input type="text" name="max_clients" size="5" maxlength="5" value="0" disabled>
                                      </td>
                                   </tr>

				<tr class="notSupported">
					<td class="propertyLabel2">Static IP Tunneling <sup title="See foot note below" onclick="alert('See foot note below');">11</sup> </td>
					<td><input type="checkbox" name="wlanStaticIpTunneling" disabled>Enabled </td>
				</tr>
                                <tr class="notSupported">
                                        <td class="propertyLabel2">Wi-Fi Direct Clients Policy</td>
                                        <td>
                                   <select name="wifiDirectClientsPolicy" disabled>
                                   <option value="Disabled" selected="">Disabled</option>
                                   <option value="Allow">Allow</option>
                                   <option value="NotAllow">Not-Allow</option>
                                   <option value="XconnectNotAllow">Xconnect-Not-Allow</option>
                                   </select>
                                        </td>
                                </tr>
                                 <tr class="notSupported">
                                      <td class="propertyLabel2">Maximum Allowed Clients Per AP Radio
                                      </td>
                                      <td>
                                      <input type="text" name="max_clients_radio" size="5" maxlength="5" value="200" disabled>
                                      </td>
                                </tr> 
				<tr class="notSupported">
					<td class="propertyLabel2">Clear HotSpot Configuration</td>
					<td><input type="checkbox" name="clear_hotSpot" disabled>Enabled </td>
				</tr>
				<tr class="notSupported">
					<td class="propertyLabel2">Client user idle timeout(15-100000)</td>
                    <td>
					    <table border="0" cellspacing="0" cellpadding="0">
					    <tbody><tr>
						   <td>
							<input type="checkbox" name="user_idle_timeout_chbx" onclick="showElementsIdleTimeout()" disabled>&nbsp;&nbsp;&nbsp;
						  </td>
                          <td>
  
                             <div id="idletimeout_id_box" style="display:none">
                                <table border="0" cellspacing="0" cellpadding="0">
                                <tbody><tr>
                                  <td>
                                      <input type="TEXT" name="clients_user_idle_timeout" size="9" maxlength="6" value="300" disabled>
                                  </td>
                                </tr>
                                <tr>
                                   <td nowrap="">&nbsp; Timeout Value (secs)</td>
                                </tr>
                                </tbody></table>
                            </div>

					      </td>
				        </tr>
				      </tbody></table>
                    </td>
				</tr>
				<tr class="notSupported">
					<td class="propertyLabel2">Client user idle threshold (0-10000000)</td>
					<td>
					<input type="text" name="clients_user_idle_threshold" size="8" maxlength="8" value="0" disabled>  Bytes 
                                        </td>
				</tr>
               <tr class="notSupported">
                   <td class="propertyLabel2">Radius NAI-Realm</td>
                    <td>
                        <input type="checkbox" name="radius_NAI_realm" disabled>
                    </td>  
               </tr>
  <!-- USMWEB_IF_WLAN_IS_WIRELESS  -->
         </tbody></table>

        
          <table cellspacing="0" cellpadding="0" border="0" class="notSupported">
             <tbody><tr>
                <td class="propertyLabel" colspan="2" nowrap="">Off Channel Scanning Defer</td>
                <td width="200">&nbsp; </td>
             </tr>
             <tr>
                <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
             </tr>
             <tr>
                <td class="propertyLabel2" width="155" valign="middle" align="left">Scan Defer Priority</td>
                <td>
                    <table cellspacing="0" cellpadding="0" border="0">
                        <tbody><tr>
                            <th align="left" scope="col">0</th>   
                            <th align="left" scope="col">1</th>   
                            <th align="left" scope="col">2</th>
                            <th align="left" scope="col">3</th>
                            <th align="left" scope="col">4</th>
                            <th align="left" scope="col">5</th>
                            <th align="left" scope="col">6</th>
                            <th align="left" scope="col">7</th>
                        </tr>
                        <tr>
                            <td>
                                <input type="checkbox" name="prio_0" onclick="prioFunc()" disabled>
                            </td>   
                            <td>
                                <input type="checkbox" name="prio_1" onclick="prioFunc()" disabled>
                            </td>   
                            <td>
                                <input type="checkbox" name="prio_2" onclick="prioFunc()" disabled>
                            </td>   
                            <td>
                                <input type="checkbox" name="prio_3" onclick="prioFunc()" disabled>
                            </td>   
                            <td>
                                <input type="checkbox" name="prio_4" onclick="prioFunc()" disabled>
                            </td>   
                            <td>
                                <input type="checkbox" name="prio_5" onclick="prioFunc()" disabled>
                            </td>   
                            <td>
                                <input type="checkbox" name="prio_6" onclick="prioFunc()" disabled>
                            </td>   
                            <td>
                                <input type="checkbox" name="prio_7" onclick="prioFunc()" disabled>
                            </td>
                        </tr>
                    </tbody></table>
                </td>
             </tr>
             <tr>
                <td>&nbsp;</td>
             </tr>     
             <tr>
                <td class="propertyLabel2" width="155">Scan Defer Time(msecs)</td>
                <td>
                    <input type="text" name="scan_defer_time" size="6" maxlength="5" value="100" disabled>
                </td>
             </tr>
          </tbody></table>
        
		
		  
			  <table cellspacing="0" cellpadding="0" border="0">
				 <tbody><tr>
				  <td class="propertyLabel" width="160">FlexConnect</td>
				  <td width="200">&nbsp; </td>
				</tr>
				<tr>
				  <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
				</tr>
				
                <tr>
                  <td class="propertyLabel2" width="155">
                    FlexConnect Local Switching <sup title="See foot note below" onclick="alert('See foot note below');">2</sup>
                  </td>
                  <td>
                      <input type="checkbox" name="reap_switching" onclick="enableLocalSwitchingParameters()" checked=""> &nbsp;Enabled
                  </td>
                </tr>

    <!-- Hiding HREAP local auth feature -->
                <tr>
                    <td class="propertyLabel2">FlexConnect Local Auth
                      <sup title="See foot note below" onclick="alert('See foot note below');">12</sup>
                    </td>
                    <td>
                        <input type="checkbox" name="reap_local_auth" onclick="enableLocalAuthParameters()" checked=""> &nbsp;Enabled
                    </td>
                </tr>
<!-- JB_FEATURES -->

                 <tr class="notSupported">
                  <td class="propertyLabel2" width="155">
                     Learn Client IP Address <sup title="See foot note below" onclick="alert('See foot note below');">5</sup>
                  </td>
                  <td>
                      <input type="checkbox" name="ignore_clientip" onclick="showLearnIPDep();checkLearnIPAgainstL2Acl() " checked="" disabled> &nbsp;Enabled
                  </td>
                </tr>				
                <tr class="notSupported">
                  <td class="propertyLabel2" width="155">
                     Vlan based Central Switching <sup title="See foot note below" onclick="alert('See foot note below');">13</sup>
                  </td>
                  <td>
                      <input type="checkbox" name="vlan_central_switching"> &nbsp;Enabled
                  </td>
                </tr>

                <tr class="notSupported">
                    <td class="propertyLabel2">Central DHCP Processing
                    </td>
                    <td>
                        <input type="checkbox" name="central_dhcp" onclick="enableNatPat()"> &nbsp;Enabled
                    </td>
                </tr>

                <tr class="notSupported">
                    <td class="propertyLabel2">Override DNS
                    </td>
                    <td>
                        <input type="checkbox" name="dns" onclick="enableLocalAuthParameters()"> &nbsp;Enabled
                    </td>
                </tr>

                <tr class="notSupported">
                    <td class="propertyLabel2">NAT-PAT</td>
                    <td>
                        <input type="checkbox" name="nat_pat" disabled=""> &nbsp;Enabled
                    </td>
                </tr>
                <tr class="notSupported">
                    <td class="propertyLabel2">Central Assoc</td>
                    <td>
                        <input type="checkbox" name="central_assoc"> &nbsp;Enabled
                    </td>
                </tr>
			  </tbody></table>
			   <!-- IF_NOT_SMB -->
              <!-- IF_WLAN_IS_WIRELESS -->

    

    
    
            <table cellspacing="0" cellpadding="0" border="0" class="notSupported">
                  <tbody><tr>
                   <td class="propertyLabel" width="160">11k</td>
                   <td width="200">&nbsp; </td>
                 </tr>
                 <tr>
              <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                 </tr>
                 <tr>
                   <td class="propertyLabel2">Assisted Roaming Prediction Optimization</td>
                   <td>
                     <input type="checkbox" name="assisted_roaming" disabled> &nbsp;Enabled
                   </td>
                 </tr>

                 <tr>
                   <td class="propertyLabel2">Neighbor List</td>
                   <td>
                     <input type="checkbox" name="neigh_list" disabled> &nbsp;Enabled
                   </td>
                 </tr>

                <tr>
                   <td class="propertyLabel2">Neighbor List Dual Band</td>
                   <td>
                     <input type="checkbox" name="neigh_dualband" disabled> &nbsp;Enabled
                   </td>
                 </tr>

             </tbody></table>
      
     
     
            </td>

		    

            <!--Start of DHCP -->
			<td valign="top" width="50%" class="notSupported">
			  <table cellspacing="0" cellpadding="0" border="0">
				<tbody><tr>
				  <td class="propertyLabel" width="160">DHCP</td>
				  <td width="200">&nbsp; </td>
				</tr>
				<tr>
				  <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
				</tr>     
				<tr>
				</tr><tr valign="top">
				  <td class="propertyLabel2">DHCP Server </td>
				  <td>
					<input type="checkbox" name="vap_dhcp_override" onclick="showElements7()">&nbsp;
					Override
				  </td>
				</tr>
				<tr>
              <td>&nbsp;</td>
              <td nowrap="" align="left">
                &nbsp;&nbsp;&nbsp;&nbsp;
                <div id="dhcp_server_box" style="display:none">
                  <table cellpadding="0" cellspacing="0" border="0">
                    <tbody><tr>
                      <td>                        
                        <input type="TEXT" name="vap_dhcpIp" size="16" maxlength="15" value="0.0.0.0">
                      </td>
                    </tr>
                    <tr>
                      <td nowrap="">&nbsp;DHCP Server IP Addr </td>
                    </tr>
                  </tbody></table>
                </div>
              </td>
            </tr>
         <!-- commented for 8.0 release later to be introduced
            <tr valign="top">
             <td class="propertyLabel2">DHCP V6 Server </td>
             <td>
             
             <INPUT type="checkbox" name="vap_dhcpv6_override" onClick="showElements7()" >&nbsp;
                                   Override
             </td>
             </tr>
             <tr> -->
          <!-- 
              <td>&nbsp;</td>
              <td nowrap  align="left">
                &nbsp;&nbsp;&nbsp;&nbsp;

                <div id="dhcp_serverv6_box" style="display:none">
                  <table cellpadding="0" cellspacing="0" border="0">
                    <tr>
                      <td>

                    
                    <tr>
                      <td>
                         <INPUT type=TEXT name="vap_dhcpIpv6" SIZE="40" MAXLENGTH="45" VALUE="">
                      </td>
                    </tr>
                    <tr>
                       <td nowrap>&nbsp;DHCP Server IPv6 Address</td>
                    </tr>
                    
                  </table>
                </div>
              </td>
            </tr>
         -->
            
	    <tr>
	      <td class="propertyLabel2">DHCP Addr. Assignment </td>
              <td>
                <input type="checkbox" name="vap_dhcp_required">&nbsp;
                Required
              </td>
            </tr>
            
            </tbody></table>
            <!-- Split Tunnel -->
            
            <table class="notSupported">
              <tbody><tr>
                <td class="propertyLabel">OEAP </td>
              </tr>
              <tr>
                <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
              </tr>
              <tr class="notSupported">
                <td>
                  <table border="0" cellspacing="0" cellpadding="0" class="notSupported">
                    <tbody><tr>
                      <td class="propertyLabel2" align="left" width="135">Split Tunnel </td>
                      <td>
                        <input type="checkbox" name="sptmode" onclick="sptCheckBox();" disabled> Enabled</td>
                    </tr>
                  </tbody></table>
                </td>
              </tr>
              <tr>
                <td>
                  <div id="spt_override_field">
                    <table border="0" cellspacing="0" cellpadding="0">
                      <tbody><tr>
                        <td class="propertyLabel2" align="left" width="135">Gateway</td>
                        <td>
                          <input type="checkbox" name="sptVapOverride" id="spt_override" onclick="sptOverrideCheckBox();" disabled>Override</td>
                      </tr>
                    </tbody></table>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div id="gw_mask_field">
                    <table border="0" cellspacing="0" cellpadding="0">
                      <tbody><tr>
                        <td class="propertyLabel2" id="gw_label" width="135">Gateway IP </td>
                        <td>
                          <input type="TEXT" name="gw" id="spt_gw" size="18" maxlength="15" value="0.0.0.0">
                        </td>
                      </tr>
                      <tr>
                        <td class="propertyLabel2" id="mask_label" width="135">Subnet Mask </td>
                        <td>
                          <input type="TEXT" name="mask" id="spt_mask" size="18" maxlength="15" value="0.0.0.0">
                        </td>
                      </tr>
                    </tbody></table>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div id="spt_acl_field">
                    <table border="0" cellspacing="0" cellpadding="0">
                      <tbody><tr>
                        <td class="propertyLabel2" id="list_label" width="135">Associated ACL</td>
                        <td>
                          <select name="oeapAclName" id="oeap_acl_name" disabled>
<option value="" selected="">None</option></select>
                        </td>
                      </tr>
                    </tbody></table>
                  </div>
                </td>
              </tr>
            </tbody></table>
            
            <!-- End of Split Tunnel -->
			<!-- MFP Code --> 
          <table cellspacing="0" cellpadding="0" border="0" class="notSupported">

            <tbody><tr>
              <td class="propertyLabel" colspan="2">Management Frame Protection (MFP)</td>              
            </tr>
            <tr>
              <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
            </tr>                 
            <tr><td colspan="2">&nbsp;</td></tr>
			<tr>
              <td class="propertyLabel2">MFP Client Protection <sup title="See foot note below" onclick="alert('See foot note below');">4</sup>
	      </td>
              <td>
                <select name="wlan_client_mfp" disabled>
                       <option value="DISABLE">Disabled</option>
                       <option value="OPTIONAL" selected="">Optional</option>
                       <option value="REQUIRED">Required</option>
                 </select>
              </td>
            </tr> 

		</tbody></table>       
        <!-- DTIM params is not applicable for Guest lans -->
        
        <table cellspacing="0" cellpadding="0" border="0" class="notSupported">
            <tbody><tr>
              <td class="propertyLabel" colspan="2">DTIM Period (in beacon intervals)</td>              
            </tr>
            <tr>
              <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
            </tr>                 
            <tr><td colspan="2">&nbsp;</td></tr>
            <!-- Remove 802 11a dtim period as SMB supports only 802 11bg -->
            
            <tr>
              <td class="propertyLabel2">802.11a/n (1 - 255)</td>
               <td>
                <input type="TEXT" name="dtim_period11a" size="16" maxlength="15" value="1" disabled>
              </td>
            </tr>
            
            <tr>
              <td class="propertyLabel2">802.11b/g/n (1 - 255)</td>
              <td>
                   <input type="TEXT" name="dtim_period11b" size="16" maxlength="15" value="1" disabled>
              </td>
            </tr> 
         </tbody></table>
         
		<!-- /EMWEB_IF KOTESH  -- >  
      

<!-- Network Admission Control NAC -->
              <table cellspacing="0" cellpadding="0" border="0" class="notSupported">
                <tbody><tr>
                  <td class="propertyLabel">NAC</td>
                  <td>&nbsp; </td>
                </tr>
                <tr>
                   <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                </tr>

                <tr>
		<td class="propertyLabel2">NAC State</td>
                <td>
                <select name="nac" onchange="nacHreapAndAaa()" disabled>
                       <option value="none" selected="">None</option>
                       <option value="nac_state">SNMP NAC</option>
             
                       <option value="posture_state">Radius NAC</option>
             
                 </select>
              </td>
              </tr>
              </tbody></table>
 <!-- IF_REMOTE_LAN -->
	   <table cellspacing="0" cellpadding="0" border="0" class="notSupported">

                <tbody><tr>
                  <td class="propertyLabel">Load Balancing and Band Select</td>
                  <td>&nbsp; </td>
                </tr>
                <tr>
                   <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                </tr>
                <tr>
                 <td class="propertyLabel2">Client Load Balancing</td>
                 <td>
                 <input type="checkbox" name="load_bal" disabled>
                 </td>
                </tr>
		<tr>
		 <td class="propertyLabel2">Client Band Select</td>
		 <td>
	         <input type="checkbox" name="band_select" disabled>
		 </td>
		</tr>

                <tr>
                  <td class="propertyLabel">Passive Client</td>
                  <td>&nbsp; </td>
                </tr>
                <tr>
                   <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                </tr>

                <tr>
                 <td class="propertyLabel2">Passive Client</td>
                 <td>
                 <input type="checkbox" name="passive_client" disabled>
                 </td>
                </tr>

                <tr>
                <td class="propertyLabel">Voice</td>
                <td>&nbsp; </td>
                </tr>
                <tr>
                <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                </tr>
                <!-- VOIP call snooping -->
                <tr>
                    <td class="propertyLabel2">Media Session Snooping</td>
                    <td>
                        <input type="checkbox" name="voip_call_failure" disabled>
                        &nbsp; Enabled
                    </td>
                </tr>

                <tr>
                    <td class="propertyLabel2">Re-anchor Roamed Voice Clients</td>
                    <td>
                        <input type="checkbox" name="re_anchor_sip_cac" disabled>
                        &nbsp; Enabled
                    </td>
                </tr>
                <tr>
                    <td class="propertyLabel2">KTS based CAC Policy</td>
                    <td>
                        <input type="checkbox" name="kts_cac_support" disabled>
                        &nbsp; Enabled
                    </td>
                </tr>
                <tr>
                <td class="propertyLabel">Radius Client Profiling</td>
                <td>&nbsp; </td>
                </tr>
                <tr>
                <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                </tr>
                <tr>
                    <td class="propertyLabel2">DHCP Profiling</td>
                    <td>
                        <input type="checkbox" name="dhcp_profiling" onclick="setProfilingDep();" disabled>
                        &nbsp; 
                    </td>
                </tr>
                <tr>
                 <td class="propertyLabel2">HTTP Profiling</td>
                 <td colspan="2"> 
		     <table border="0" cellspacing="0" cellpadding="0">
                     <tbody><tr>
	              <td>
                          <input type="checkbox" name="http_profiling" onclick="showHttpTimeOut();" value="disable" disabled>
                      </td>
                      <!-- to be introduced later
                      <td>
                         <div id="http_profiling_timeout" style="display:none">
                             <table border="0" cellspacing="0" cellpadding="0">
                               <tr>
                                  <td>
                                      <INPUT type=TEXT name="http_timeout" SIZE="6" MAXLENGTH="5" VALUE="0">
                                  </td>
                               </tr>
                               <tr>
                                   <td nowrap>&nbsp; HTTP Timeout (secs)</td>
                               </tr>
                             </table>
                          </div>
		     </td>
                     -->
		     </tr>
                     </tbody></table>
                   </td>
                 </tr>   
                <tr>
                <td class="propertyLabel">Local Client Profiling</td>
                <td>&nbsp; </td>
                </tr>
                <tr>
                <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                </tr>
                <tr>
                    <td class="propertyLabel2">DHCP Profiling</td>
                    <td>
                        <input type="checkbox" name="local_dhcp_profiling" onclick="setLocalProfilingDep();" disabled>
                        &nbsp; 
                    </td>
                </tr>
                <tr>
                 <td class="propertyLabel2">HTTP Profiling</td>
	              <td>
                          <input type="checkbox" name="local_http_profiling" value="disable" disabled>
                      </td>
                 </tr>   
                  <!--USMWEB_IS_PMIP_SUPPORTED -->
                 <tr>
                 <td class="propertyLabel">Universal AP Admin Support</td>
                 <td>&nbsp; </td>
                 </tr>
                 <tr>
                 <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                 </tr>
                 <tr>
                     <td class="propertyLabel2">Universal AP Admin</td>
                     <td>
                         <input type="checkbox" name="universal_admin" value="disable" disabled>
                         &nbsp;
                     </td>
                 </tr>
                 <tr>
                   <td class="propertyLabel">11v BSS Transition Support</td>
                   <td>&nbsp; </td>
                 </tr>
                 <tr>
                   <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                 </tr>
                 <tr>
                   <td class="propertyLabel2">BSS Transition</td>
                   <td>
                     <input type="checkbox" name="dot11vBssTransition" value="disable" disabled>
                     &nbsp;
                   </td>
                 </tr>
                 <tr>
                   <td class="propertyLabel2">Disassociation Imminent</td>
                   <td>
                     <input type="checkbox" name="disassociation_imminent" value="disable" disabled>
                     &nbsp;
                   </td>
                 </tr>
                 <tr>
                   <td class="propertyLabel2">Disassociation Timer(0 to 3000 TBTT)</td>
                   <td>
                     <input type="text" name="disassoc_timer" size="6" maxlength="5" value="200" disabled>
                     &nbsp;
                   </td>
                 </tr>
                 <tr>
                   <td class="propertyLabel2">Optimized Roaming Disassociation Timer(0 to 40 TBTT)</td>
                   <td>
                     <input type="text" name="disassoc_timer_op" size="6" maxlength="5" value="40" disabled>
                     &nbsp;
                   </td>
                 </tr>
                 <tr>
                  <td class="propertyLabel">Tunneling</td>
                  <td>&nbsp; </td>
                 </tr>
                 <tr>
                  <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                 </tr>
                 <tr>
                  <td class="propertyLabel2">Tunnel Profile</td>
                  <td>
                    <select name="tunnel_profile" id="tunnel_profile" disabled>
<option value="None" selected="">None</option></select>
                      &nbsp;
                  </td>
                 </tr>

 <!-- IF_WLAN_IS_WIRELESS -->
 
                 <tr>
                     <td class="propertyLabel">mDNS</td>
                     <td>&nbsp;</td>
                 </tr>
                 <tr>
                    <td class="lineProp" colspan="2"><img alt="" width="1" height="1"></td>
                 </tr>
                 <tr>
                     <td class="propertyLabel2">mDNS Snooping</td>
                     <td>
                         <input type="checkbox" name="bonjour_profiling" onclick="displayBonjour();flexCheck();" disabled>
                         &nbsp; Enabled
                     </td>
                 </tr>
               <tr>
               <td colspan="2">
               <div id="bonjour_div" style="display:none">
               <table border="0" cellspacing="0" cellpadding="0">
                   <tbody><tr>
                       <td class="propertyLabel2">mDNS Profile</td>
                       <td>
                          <select name="wlanBnjProfile" disabled>
<option value="none" selected="">none
</option><option value="default-mdns-profile">default-mdns-profile</option></select>
                       </td>
                     </tr>
               </tbody></table>
               </div>
               </td>
               </tr>
  <!-- IF_REMOTE_LAN -->
               </tbody></table>
           </td></tr></tbody></table>

          
         
       
     </div>
   </div>
   <!-------- end 'Advanced' tab ---->
 </div>
</div>
  
  
 <table cellpadding="0" cellspacing="0" border="0">
        <tr>
        <td colspan="2" width="100%" class="propertyLabel" style="padding-left: 16px">Foot Notes</td>
        </tr>


		  <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>1  Web Policy cannot be used in combination with IPsec  </em>
            </td>
          </tr>


		  <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>2(a) FlexConnect Local Switching is not supported with IPsec, CRANITE  authentication, Override Interface ACLs  </em>
            </td>
          </tr>
		  <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>2(b) When flexconnect local authentication is enabled, irrespective of AP on connected or standalone mode the AP will act as NAS  </em>
            </td>
          </tr>
		  <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>2(c) When flexconnect local authentication is disabled, AP on connected mode will use WLC as NAS and AP as NAS while its on standalone mode  </em>
            </td>
          </tr>


		  <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>3  When client exclusion is enabled, a Timeout Value of zero means infinity (will require administrative override to reset excluded clients)  </em>
            </td>
          </tr>

		  <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>4  Client MFP is not active unless WPA2 is configured</em>
            </td>
          </tr>


        <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>5  Learn Client IP is configurable only when FlexConnect Local Switching is enabled</em>
            </td>
        </tr>
        <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>6  WMM and open or AES security should be enabled to support higher 11n rates </em>
            </td>
        </tr>

       <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
             <em>8 Value zero implies there is no restriction on maximum clients allowed. </em>
            </td>
        </tr>

        <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>9 MAC Filtering is not supported with FlexConnect Local authentication  </em>
            </td>
        </tr>

        <!-- IF NOT SMB -->
	  

        <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>10  MAC Filtering should be enabled. </em>
            </td>
        </tr>
        <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>11  Guest tunneling, Local switching, DHCP Required should be disabled. </em>
            </td>
        </tr>
        <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>12  Max-associated-clients feature and Central Assoc feature are not supported with FlexConnect Local Authentication. </em>
            </td>
        </tr>
        <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>13  VLAN based central switching is not supported with FlexConnect Local Authentication. </em>
            </td>
        </tr>
        <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>14  Enabling gtk-randomize will prevent clients from decrypting  broadcast and multicast packets. </em>
            </td>
        </tr>
        <tr>
            <td colspan="2" width="100%" style="padding-left: 16px">
              <em>15  Fast Transition is supported with WPA2  and open security policy  </em>
            </td>
        </tr>
         <tr>
             <td colspan="2" width="100%" style="padding-left: 16px">
               <em>16  Override Bandwidth Contracts parameters are specific to per Radio of AP. A value of zero (0) indicates that the value specified in the selected QoS profile will take effect. </em>
             </td>
         </tr>
         <tr>
             <td colspan="2" width="100%" style="padding-left: 16px">
               <em>18 When Diagnostic Channel is enabled, P2P Blocking Action will be assigned to Drop Action</em>
             </td>
         </tr>


 <!-- IF WIRELESS --> 



</table>

  <INPUT TYPE="hidden" NAME="vap_id" SIZE="3" MAXLENGTH="2" VALUE="<?=WLAN-ID=?>">
  <INPUT TYPE="hidden" NAME="qos_val" SIZE="16" MAXLENGTH="15" VALUE="Silver (best effort)">
  <INPUT TYPE="hidden" NAME="wpa_key_length" SIZE="1" MAXLENGTH="1" VALUE="0">
  <INPUT TYPE="hidden" NAME="secPolicy" SIZE="1" MAXLENGTH="1" VALUE="0">
  <INPUT TYPE="hidden" NAME="RSN_key_length" SIZE="1" MAXLENGTH="1" VALUE="0">
  <INPUT TYPE="hidden" NAME="note_128_earlier" SIZE="1" MAXLENGTH="1" VALUE="0">
  <INPUT TYPE="hidden" NAME="err_flag" SIZE="16" MAXLENGTH="15" VALUE="0">
  <INPUT TYPE="hidden" NAME="err_msg" SIZE="512" MAXLENGTH="511" VALUE="">
  <INPUT TYPE="hidden" NAME="info_flag" SIZE="16" MAXLENGTH="15" VALUE="0">
  <INPUT TYPE="hidden" NAME="info_msg" SIZE="512" MAXLENGTH="511" VALUE="">
  <INPUT TYPE="hidden" NAME="buttonClicked" SIZE="16" MAXLENGTH="15" VALUE="0">
  <INPUT TYPE="hidden" NAME="no_prio_sel" SIZE="1" MAXLENGTH="1" VALUE="1">
  <INPUT TYPE="hidden" NAME="mgmt_prtyOrder" SIZE="512" MAXLENGTH="511" VALUE="">
  <INPUT TYPE="hidden" NAME="mgmt_prtyOrder2" SIZE="512" MAXLENGTH="511" VALUE="">
  <INPUT type="hidden" name="query_str" size="512" maxlength="512" VALUE="">
  <INPUT TYPE="hidden" NAME="hotSpotStatus" SIZE="3" MAXLENGTH="2" VALUE="0">
  <INPUT TYPE="hidden" NAME="indexClicked" SIZE="16" MAXLENGTH="15" VALUE="0">
  <INPUT TYPE="hidden" NAME="dot1xflag" SIZE="1" MAXLENGTH="1" VALUE="1">
  <INPUT TYPE="hidden" NAME="assisted_roamval" SIZE="5" MAXLENGTH="5" VALUE="0">
  <INPUT TYPE="hidden" NAME="neighbor_listval" SIZE="5" MAXLENGTH="5" VALUE="0">
</FORM>



<script>
//buildMenu();
   document.forms[0].buttonClicked.value = 0; // reinitialize the button clicked
if(document.forms[0].vap_profileName.value != null)
{
      var getElmId = document.getElementById("headerprof");
      getElmId.innerHTML = "WLANs &gt; Edit&nbsp;&nbsp; '" +  replaceSpecialCharacter(document.forms[0].vap_profileName.value) + "'";
}
</script>



<?=PAGE-FOOTER=?>
